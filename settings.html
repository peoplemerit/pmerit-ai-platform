<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Settings - PMERIT Platform</title>
  <meta name="description" content="Manage your account settings and preferences on PMERIT.">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  
  <!-- PMERIT Standard CSS Imports -->
  <link rel="stylesheet" href="assets/css/theme-variables.css">
  <link rel="stylesheet" href="assets/css/typography.css">
  <link rel="stylesheet" href="assets/css/base.css">
  <link rel="stylesheet" href="assets/css/components.css">
  
  <!-- Auth protection -->
  <script src="assets/js/config.js"></script>
  <script src="assets/js/auth.js"></script>
  <script src="assets/js/auth-check.js"></script>
  <script src="assets/js/tts.js" defer></script>

  <style>
    .settings-container {
      max-width: 800px;
      margin: 0 auto;
      padding: var(--space-8);
    }

    .settings-header {
      margin-bottom: var(--space-8);
    }

    .settings-header h1 {
      font-size: var(--text-4xl);
      font-weight: var(--font-bold);
      color: var(--text-primary);
      margin-bottom: var(--space-2);
    }

    .settings-header p {
      color: var(--text-secondary);
      font-size: var(--text-lg);
    }

    .settings-section {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius-lg);
      padding: var(--space-6);
      margin-bottom: var(--space-6);
      box-shadow: var(--shadow);
    }

    .settings-section h2 {
      font-size: var(--text-2xl);
      font-weight: var(--font-semibold);
      color: var(--text-primary);
      margin-bottom: var(--space-4);
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .settings-section h2 i {
      color: var(--color-primary);
    }

    .setting-item {
      margin-bottom: var(--space-5);
    }

    .setting-item:last-child {
      margin-bottom: 0;
    }

    .setting-label {
      display: block;
      font-weight: var(--font-semibold);
      color: var(--text-primary);
      margin-bottom: var(--space-2);
    }

    .setting-description {
      color: var(--text-secondary);
      font-size: var(--text-sm);
      margin-bottom: var(--space-3);
    }

    .setting-select {
      width: 100%;
      padding: var(--space-3);
      border: 2px solid var(--border-color);
      border-radius: var(--border-radius-md);
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: var(--text-base);
      transition: var(--transition);
    }

    .setting-select:focus {
      outline: none;
      border-color: var(--color-primary);
    }

    .test-button {
      background-color: var(--color-primary);
      color: white;
      padding: var(--space-2) var(--space-4);
      border: none;
      border-radius: var(--border-radius-md);
      font-weight: var(--font-semibold);
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: var(--space-2);
      margin-top: var(--space-3);
    }

    .test-button:hover {
      background-color: var(--color-primary-dark);
      transform: translateY(-2px);
    }

    .test-button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .status-message {
      padding: var(--space-3);
      border-radius: var(--border-radius-md);
      margin-top: var(--space-3);
      font-size: var(--text-sm);
      display: none;
    }

    .status-message.success {
      background-color: rgba(16, 185, 129, 0.1);
      color: var(--color-success);
      border: 1px solid var(--color-success);
      display: block;
    }

    .status-message.error {
      background-color: rgba(239, 68, 68, 0.1);
      color: var(--color-error);
      border: 1px solid var(--color-error);
      display: block;
    }

    .status-message.info {
      background-color: rgba(59, 130, 246, 0.1);
      color: var(--color-info);
      border: 1px solid var(--color-info);
      display: block;
    }

    .coming-soon-container {
      display: none;
    }
    
    .btn-primary {
      background-color: var(--color-primary);
      color: white;
      padding: var(--space-3) var(--space-6);
      border-radius: var(--border-radius-md);
      text-decoration: none;
      font-weight: var(--font-semibold);
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: var(--space-2);
    }
    
    .btn-primary:hover {
      background-color: var(--color-primary-dark);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }
    
    .btn-secondary {
      background-color: var(--bg-secondary);
      color: var(--color-primary);
      padding: var(--space-3) var(--space-6);
      border-radius: var(--border-radius-md);
      text-decoration: none;
      font-weight: var(--font-semibold);
      border: 2px solid var(--border-color);
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: var(--space-2);
    }
    
    .btn-secondary:hover {
      border-color: var(--color-primary);
      transform: translateY(-2px);
    }
  </style>
</head>
<body>
  <!-- Simple header for placeholder page -->
  <header style="background: var(--bg-card); padding: var(--space-4); border-bottom: 1px solid var(--border-color); box-shadow: var(--shadow);">
    <div style="max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center;">
      <a href="index.html" style="text-decoration: none; color: var(--color-primary); font-weight: var(--font-bold); font-size: var(--text-2xl);">
        ðŸŽ“ PMERIT
      </a>
      <nav style="display: flex; gap: var(--space-4); align-items: center;">
        <a href="index.html" style="text-decoration: none; color: var(--text-secondary);">Home</a>
        <a href="career.html" style="text-decoration: none; color: var(--text-secondary);">Career Track</a>
        <a href="assessment.html" style="text-decoration: none; color: var(--text-secondary);">Assessment</a>
        <a href="profile.html" style="text-decoration: none; color: var(--text-secondary);">Profile</a>
        <a href="signin.html" class="btn-primary" style="font-size: var(--text-sm); padding: var(--space-2) var(--space-4);">Sign In</a>
      </nav>
    </div>
  </header>

  <main class="settings-container">
    <div class="settings-header">
      <h1>Settings</h1>
      <p>Manage your PMERIT platform preferences</p>
    </div>

    <!-- TTS Settings Section -->
    <div class="settings-section">
      <h2>
        <i class="fas fa-volume-up"></i>
        Text-to-Speech Voice
      </h2>

      <div class="setting-item">
        <label class="setting-label" for="voiceEngineSelect">Voice Engine</label>
        <p class="setting-description">
          Choose the voice engine for text-to-speech. Cloudflare Workers AI models provide high-quality, natural voices. Browser fallback uses your device's built-in speech synthesis.
        </p>
        <select id="voiceEngineSelect" class="setting-select">
          <option value="aura-2-en">Deepgram Aura 2 (English) - Recommended</option>
          <option value="aura-1">Deepgram Aura 1 (Multi-language)</option>
          <option value="melotts">MeloTTS (Expressive)</option>
          <option value="aura-2-es">Deepgram Aura 2 (Spanish)</option>
          <option value="browser">Browser Speech (Fallback)</option>
        </select>

        <button id="testVoiceBtn" class="test-button">
          <i class="fas fa-play"></i>
          Test Voice
        </button>

        <div id="ttsStatus" class="status-message"></div>
      </div>
    </div>

    <!-- Coming Soon Section -->
    <div class="settings-section">
      <h2>
        <i class="fas fa-cog"></i>
        Additional Settings
      </h2>
      <p class="setting-description">
        More settings including notifications, privacy, and account preferences are coming soon.
      </p>
    </div>
  </main>

  <!-- Simple footer -->
  <footer style="background: var(--bg-card); border-top: 1px solid var(--border-color); padding: var(--space-4); margin-top: auto;">
    <div style="max-width: 1400px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: var(--space-4);">
      <div style="display: flex; align-items: center; gap: var(--space-2);">
        <i class="fas fa-circle" style="color: var(--color-success); font-size: 0.5rem;"></i>
        <span style="color: var(--text-secondary); font-size: var(--text-sm);">Connected to Educational Services</span>
      </div>
      <div style="display: flex; gap: var(--space-4);">
        <a href="privacy.html" style="color: var(--text-secondary); text-decoration: none; font-size: var(--text-sm);">Privacy & Terms</a>
        <a href="contact.html" style="color: var(--text-secondary); text-decoration: none; font-size: var(--text-sm);">Contact</a>
        <a href="partnerships.html" style="color: var(--text-secondary); text-decoration: none; font-size: var(--text-sm);">Partnerships</a>
        <a href="support.html" style="color: var(--text-secondary); text-decoration: none; font-size: var(--text-sm);">Support</a>
      </div>
    </div>
  </footer>

  <script src="assets/js/main.js"></script>
  <script>
    // TTS Settings Management
    (function() {
      'use strict';

      const voiceEngineSelect = document.getElementById('voiceEngineSelect');
      const testVoiceBtn = document.getElementById('testVoiceBtn');
      const ttsStatus = document.getElementById('ttsStatus');

      // Load current settings
      function loadSettings() {
        if (window.TTS && window.TTS.getVoiceEngine) {
          const currentEngine = window.TTS.getVoiceEngine();
          voiceEngineSelect.value = currentEngine;
        }
      }

      // Show status message
      function showStatus(message, type = 'info') {
        ttsStatus.textContent = message;
        ttsStatus.className = `status-message ${type}`;
      }

      // Hide status message
      function hideStatus() {
        ttsStatus.className = 'status-message';
      }

      // Handle voice engine change
      voiceEngineSelect.addEventListener('change', function() {
        const selectedEngine = this.value;

        if (window.TTS && window.TTS.setVoiceEngine) {
          window.TTS.setVoiceEngine(selectedEngine);
          showStatus('Voice engine updated successfully!', 'success');

          // Hide success message after 3 seconds
          setTimeout(hideStatus, 3000);
        }
      });

      // Handle test voice button
      testVoiceBtn.addEventListener('click', async function() {
        const testText = 'Hello! This is a test of the text-to-speech voice. I hope you find it clear and natural.';
        const selectedEngine = voiceEngineSelect.value;

        // Disable button during test
        testVoiceBtn.disabled = true;
        testVoiceBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Testing...';
        showStatus('Testing voice...', 'info');

        try {
          if (window.TTS && window.TTS.speak) {
            await window.TTS.speak(testText, {
              voiceEngine: selectedEngine,
              useServer: selectedEngine !== 'browser'
            });
            showStatus('Voice test completed successfully!', 'success');
          } else {
            throw new Error('TTS module not loaded');
          }
        } catch (error) {
          console.error('Voice test error:', error);
          showStatus(`Error: ${error.message}. Using browser fallback.`, 'error');
        } finally {
          // Re-enable button
          testVoiceBtn.disabled = false;
          testVoiceBtn.innerHTML = '<i class="fas fa-play"></i> Test Voice';

          // Hide status after 5 seconds
          setTimeout(hideStatus, 5000);
        }
      });

      // Listen for TTS fallback events
      document.addEventListener('tts:fallback', function(e) {
        showStatus(e.detail?.message || 'Fallback to browser speech', 'info');
        setTimeout(hideStatus, 5000);
      });

      // Load settings when page loads
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadSettings);
      } else {
        loadSettings();
      }
    })();
  </script>
</body>
</html>
