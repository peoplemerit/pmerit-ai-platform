<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="PMERIT User Dashboard - Manage your courses, track progress, access career resources and learning materials">
  <meta name="keywords" content="PMERIT dashboard, my courses, career center, learning progress, educational platform">
  <meta name="author" content="PMERIT AI Platform">
  <meta name="theme-color" content="#4F46E5">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://pmerit.com/dashboard.html">
  <meta property="og:title" content="My Dashboard - PMERIT AI Platform">
  <meta property="og:description" content="Access your personalized learning dashboard with courses, career guidance, and educational resources.">
  <meta property="og:image" content="https://pmerit.com/assets/images/dashboard-og.png">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://pmerit.com/dashboard.html">
  <meta property="twitter:title" content="My Dashboard - PMERIT AI Platform">
  <meta property="twitter:description" content="Access your personalized learning dashboard with courses, career guidance, and educational resources.">
  <meta property="twitter:image" content="https://pmerit.com/assets/images/dashboard-twitter.png">

  <title>My Dashboard - PMERIT AI Platform</title>
  
  <!-- Preconnect to external domains -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://ai.pmerit.com">
  
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  
  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QkAfRGJA+Ysg==" crossorigin="anonymous" referrerpolicy="no-referrer">
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  <!-- Base CSS - Design System -->
  <link rel="stylesheet" href="/assets/base.css">
  
  <!-- Dashboard-specific styles -->
  <style>
    /* Dashboard specific styling */
    .dashboard-welcome {
      background: linear-gradient(135deg, var(--primary-light) 0%, var(--bg-primary) 100%);
      border-radius: var(--radius-lg);
      padding: var(--space-6);
      margin-bottom: var(--space-6);
      border: 1px solid var(--border-light);
    }
    
    .welcome-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--space-4);
    }
    
    .welcome-text h1 {
      font-size: var(--font-size-2xl);
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: var(--space-2);
    }
    
    .welcome-subtitle {
      color: var(--text-secondary);
      font-size: var(--font-size-base);
    }
    
    .user-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-inverse);
      font-size: var(--font-size-2xl);
      font-weight: 700;
    }
    
    .dashboard-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-4);
      margin-top: var(--space-4);
    }
    
    .stat-card {
      background: var(--bg-primary);
      padding: var(--space-4);
      border-radius: var(--radius-md);
      border: 1px solid var(--border-color);
      text-align: center;
    }
    
    .stat-number {
      font-size: var(--font-size-3xl);
      font-weight: 700;
      color: var(--primary);
      margin-bottom: var(--space-1);
    }
    
    .stat-label {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
    }
    
    .dashboard-sections {
      display: grid;
      gap: var(--space-6);
      margin-bottom: var(--space-6);
    }
    
    .dashboard-section {
      background: var(--bg-primary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-sm);
    }
    
    .section-header {
      padding: var(--space-4) var(--space-6);
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border-color);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .section-title {
      display: flex;
      align-items: center;
      gap: var(--space-2);
      font-size: var(--font-size-lg);
      font-weight: 600;
      color: var(--text-primary);
      margin: 0;
    }
    
    .section-icon {
      color: var(--primary);
    }
    
    .section-action {
      font-size: var(--font-size-sm);
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
    }
    
    .section-action:hover {
      text-decoration: underline;
    }
    
    .section-content {
      padding: var(--space-6);
    }
    
    .course-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: var(--space-4);
    }
    
    .course-card {
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      padding: var(--space-4);
      border: 1px solid var(--border-light);
      transition: all var(--transition-fast);
      cursor: pointer;
    }
    
    .course-card:hover {
      border-color: var(--primary);
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }
    
    .course-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      margin-bottom: var(--space-3);
    }
    
    .course-icon {
      width: 50px;
      height: 50px;
      border-radius: var(--radius-md);
      background: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-inverse);
      font-size: var(--font-size-lg);
    }
    
    .course-status {
      font-size: var(--font-size-xs);
      padding: var(--space-1) var(--space-2);
      border-radius: var(--radius-sm);
      font-weight: 500;
    }
    
    .status-active {
      background: var(--success);
      color: var(--text-inverse);
    }
    
    .status-completed {
      background: var(--accent);
      color: var(--text-inverse);
    }
    
    .status-paused {
      background: var(--warning);
      color: var(--text-primary);
    }
    
    .course-title {
      font-size: var(--font-size-base);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-2);
    }
    
    .course-description {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      margin-bottom: var(--space-3);
      line-height: var(--leading-relaxed);
    }
    
    .course-progress {
      margin-bottom: var(--space-3);
    }
    
    .progress-label {
      display: flex;
      justify-content: space-between;
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
      margin-bottom: var(--space-1);
    }
    
    .progress-bar {
      width: 100%;
      height: 6px;
      background: var(--border-color);
      border-radius: var(--radius-sm);
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
      transition: width 0.3s ease;
      border-radius: var(--radius-sm);
    }
    
    .course-actions {
      display: flex;
      gap: var(--space-2);
    }
    
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: var(--space-4);
      margin-bottom: var(--space-6);
    }
    
    .quick-action-card {
      background: var(--bg-primary);
      border: 2px solid var(--border-color);
      border-radius: var(--radius-lg);
      padding: var(--space-4);
      text-align: center;
      cursor: pointer;
      transition: all var(--transition-fast);
      text-decoration: none;
      color: inherit;
    }
    
    .quick-action-card:hover {
      border-color: var(--primary);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }
    
    .quick-action-icon {
      font-size: 2.5rem;
      color: var(--primary);
      margin-bottom: var(--space-3);
    }
    
    .quick-action-title {
      font-size: var(--font-size-lg);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--space-2);
    }
    
    .quick-action-description {
      font-size: var(--font-size-sm);
      color: var(--text-secondary);
    }
    
    .recent-activities {
      margin-top: var(--space-4);
    }
    
    .activity-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .activity-item {
      display: flex;
      align-items: center;
      padding: var(--space-3);
      border-bottom: 1px solid var(--border-light);
    }
    
    .activity-item:last-child {
      border-bottom: none;
    }
    
    .activity-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--primary-light);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary);
      margin-right: var(--space-3);
    }
    
    .activity-content {
      flex: 1;
    }
    
    .activity-title {
      font-size: var(--font-size-sm);
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: var(--space-1);
    }
    
    .activity-time {
      font-size: var(--font-size-xs);
      color: var(--text-tertiary);
    }
    
    .empty-state {
      text-align: center;
      padding: var(--space-8);
      color: var(--text-secondary);
    }
    
    .empty-state-icon {
      font-size: 3rem;
      color: var(--text-tertiary);
      margin-bottom: var(--space-3);
    }
    
    .empty-state-title {
      font-size: var(--font-size-lg);
      font-weight: 600;
      margin-bottom: var(--space-2);
    }
    
    .empty-state-description {
      margin-bottom: var(--space-4);
    }
    
    /* Mobile Responsive */
    @media (max-width: 768px) {
      .welcome-header {
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: var(--space-4);
      }
      
      .dashboard-stats {
        grid-template-columns: repeat(2, 1fr);
      }
      
      .quick-actions {
        grid-template-columns: 1fr;
      }
      
      .course-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "PMERIT User Dashboard",
    "description": "Personalized learning dashboard for PMERIT AI educational platform",
    "provider": {
      "@type": "EducationalOrganization",
      "name": "PMERIT",
      "url": "https://pmerit.com"
    },
    "applicationCategory": "EducationalApplication",
    "operatingSystem": "Web Browser"
  }
  </script>
</head>

<body class="app-layout">
  <!-- Skip Navigation Link for Accessibility -->
  <a href="#main-content" class="skip-link">Skip to main content</a>
  
  <!-- Header Container - Loaded via boot-includes.js -->
  <div id="header-container" role="banner"></div>

  <!-- Main Application Layout -->
  <div class="estate">
    <!-- Left Navigation Sidebar - Loaded via boot-includes.js -->
    <div id="nav-container" role="navigation" aria-label="Main navigation"></div>

    <!-- Main Content Area -->
    <main id="main-content" role="main" tabindex="-1">
      
      <!-- Dashboard Welcome Section -->
      <section class="dashboard-welcome">
        <div class="welcome-header">
          <div class="welcome-text">
            <h1 id="welcomeMessage">Welcome back, <span id="userName">Loading...</span>!</h1>
            <p class="welcome-subtitle" id="welcomeSubtitle">Continue your learning journey and achieve your career goals.</p>
          </div>
          <div class="user-avatar" id="userAvatar">
            <i class="fas fa-user" aria-hidden="true"></i>
          </div>
        </div>
        
        <!-- Dashboard Stats -->
        <div class="dashboard-stats">
          <div class="stat-card">
            <div class="stat-number" id="enrolledCourses">0</div>
            <div class="stat-label">Enrolled Courses</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="completedCourses">0</div>
            <div class="stat-label">Completed Courses</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="studyHours">0</div>
            <div class="stat-label">Study Hours</div>
          </div>
          <div class="stat-card">
            <div class="stat-number" id="certificatesEarned">0</div>
            <div class="stat-label">Certificates</div>
          </div>
        </div>
      </section>

      <!-- Quick Actions -->
      <section class="quick-actions">
        <a href="/assessment.html" class="quick-action-card">
          <i class="fas fa-compass quick-action-icon" aria-hidden="true"></i>
          <h3 class="quick-action-title">Discover Your Path</h3>
          <p class="quick-action-description">Take our AI assessment to find your ideal career</p>
        </a>
        
        <a href="/courses.html" class="quick-action-card">
          <i class="fas fa-search quick-action-icon" aria-hidden="true"></i>
          <h3 class="quick-action-title">Browse Courses</h3>
          <p class="quick-action-description">Explore our comprehensive course catalog</p>
        </a>
        
        <a href="/career.html" class="quick-action-card">
          <i class="fas fa-briefcase quick-action-icon" aria-hidden="true"></i>
          <h3 class="quick-action-title">Career Center</h3>
          <p class="quick-action-description">Find jobs and career opportunities</p>
        </a>
        
        <a href="/library.html" class="quick-action-card">
          <i class="fas fa-book-open quick-action-icon" aria-hidden="true"></i>
          <h3 class="quick-action-title">Learning Library</h3>
          <p class="quick-action-description">Access resources and documentation</p>
        </a>
      </section>

      <!-- Dashboard Sections -->
      <div class="dashboard-sections">
        
        <!-- My Courses Section -->
        <section class="dashboard-section">
          <div class="section-header">
            <h2 class="section-title">
              <i class="fas fa-graduation-cap section-icon" aria-hidden="true"></i>
              My Courses
            </h2>
            <a href="/courses.html" class="section-action">View All Courses</a>
          </div>
          <div class="section-content">
            <div class="course-grid" id="myCourses">
              <!-- Courses will be loaded dynamically -->
            </div>
            <div class="empty-state" id="coursesEmptyState" style="display: none;">
              <i class="fas fa-book-open empty-state-icon" aria-hidden="true"></i>
              <h3 class="empty-state-title">No Courses Yet</h3>
              <p class="empty-state-description">Start your learning journey by enrolling in a course.</p>
              <a href="/courses.html" class="btn btn-primary">Browse Courses</a>
            </div>
          </div>
        </section>

        <!-- Recent Progress Section -->
        <section class="dashboard-section">
          <div class="section-header">
            <h2 class="section-title">
              <i class="fas fa-chart-line section-icon" aria-hidden="true"></i>
              Recent Progress
            </h2>
            <a href="/progress.html" class="section-action">View Full Progress</a>
          </div>
          <div class="section-content">
            <div class="recent-activities">
              <ul class="activity-list" id="recentActivities">
                <!-- Activities will be loaded dynamically -->
              </ul>
            </div>
            <div class="empty-state" id="activitiesEmptyState" style="display: none;">
              <i class="fas fa-chart-bar empty-state-icon" aria-hidden="true"></i>
              <h3 class="empty-state-title">No Recent Activity</h3>
              <p class="empty-state-description">Your recent learning activities will appear here.</p>
            </div>
          </div>
        </section>

        <!-- Career Recommendations Section -->
        <section class="dashboard-section">
          <div class="section-header">
            <h2 class="section-title">
              <i class="fas fa-bullseye section-icon" aria-hidden="true"></i>
              Career Recommendations
            </h2>
            <a href="/career.html" class="section-action">Explore Careers</a>
          </div>
          <div class="section-content">
            <div id="careerRecommendations">
              <!-- Career recommendations will be loaded dynamically -->
            </div>
            <div class="empty-state" id="careersEmptyState">
              <i class="fas fa-compass empty-state-icon" aria-hidden="true"></i>
              <h3 class="empty-state-title">Discover Your Path</h3>
              <p class="empty-state-description">Take our AI assessment to get personalized career recommendations.</p>
              <a href="/assessment.html" class="btn btn-primary">Begin Assessment</a>
            </div>
          </div>
        </section>

      </div>
    </main>

    <!-- Right Panel - User Profile & Quick Links -->
    <aside id="right-panel" role="complementary" aria-label="User profile and quick links">
      
      <!-- User Profile Section -->
      <section class="user-profile-section">
        <h4>
          <i class="fas fa-user-circle" aria-hidden="true"></i>
          My Profile
        </h4>
        <div class="profile-content">
          <div class="profile-avatar" id="profileAvatar">
            <i class="fas fa-user" aria-hidden="true"></i>
          </div>
          <div class="profile-info">
            <h5 id="profileName">Loading...</h5>
            <p id="profileRole">Student</p>
            <p id="profileEmail">Loading...</p>
          </div>
          <div class="profile-actions">
            <a href="/profile.html" class="btn btn-sm btn-outline">Edit Profile</a>
          </div>
        </div>
      </section>

      <!-- Quick Links Section -->
      <section class="quick-links-section">
        <h4>
          <i class="fas fa-bolt" aria-hidden="true"></i>
          Quick Links
        </h4>
        <div class="quick-links-list">
          <a href="/classroom.html" class="quick-link">
            <i class="fas fa-chalkboard" aria-hidden="true"></i>
            <span>Virtual Classroom</span>
          </a>
          <a href="/certificates.html" class="quick-link">
            <i class="fas fa-certificate" aria-hidden="true"></i>
            <span>My Certificates</span>
          </a>
          <a href="/help.html" class="quick-link">
            <i class="fas fa-question-circle" aria-hidden="true"></i>
            <span>Help & Support</span>
          </a>
          <a href="/progress.html" class="quick-link">
            <i class="fas fa-chart-line" aria-hidden="true"></i>
            <span>Learning Progress</span>
          </a>
        </div>
      </section>

      <!-- Study Streak Section -->
      <section class="study-streak-section">
        <h4>
          <i class="fas fa-fire" aria-hidden="true"></i>
          Study Streak
        </h4>
        <div class="streak-info">
          <div class="streak-number" id="studyStreak">0</div>
          <div class="streak-label">days in a row</div>
          <p class="streak-message" id="streakMessage">Start learning today to begin your streak!</p>
        </div>
      </section>

    </aside>
  </div>

  <!-- Footer Container - Loaded via boot-includes.js -->
  <div id="footer-container" role="contentinfo"></div>

  <!-- Dashboard JavaScript -->
  <script>
    /**
     * PMERIT Dashboard Handler
     * Manages dashboard data loading and user interactions
     */
    class PMERITDashboard {
      constructor() {
        this.user = null;
        this.initialized = false;
        
        // Wait for boot system to complete
        window.addEventListener('pmerit:initialized', () => {
          this.initialize();
        });
        
        // Fallback initialization
        setTimeout(() => {
          if (!this.initialized) {
            this.initialize();
          }
        }, 2000);
      }

      async initialize() {
        if (this.initialized) return;
        
        console.log('[PMERIT] Initializing dashboard...');
        
        // Check authentication
        await this.checkAuthentication();
        
        if (!this.user) {
          this.redirectToSignIn();
          return;
        }
        
        // Load dashboard data
        await this.loadDashboardData();
        
        this.initialized = true;
        console.log('[PMERIT] âœ“ Dashboard initialized');
      }

      /**
       * Check if user is authenticated
       */
      async checkAuthentication() {
        try {
          const response = await fetch('/api/auth/me', {
            method: 'GET',
            credentials: 'include',
            headers: {
              'Accept': 'application/json'
            }
          });

          if (response.ok) {
            this.user = await response.json();
            console.log('[PMERIT] User authenticated:', this.user.name);
          } else {
            console.log('[PMERIT] User not authenticated');
            this.user = null;
          }
        } catch (error) {
          console.error('[PMERIT] Authentication check failed:', error);
          this.user = null;
        }
      }

      /**
       * Redirect unauthenticated users
       */
      redirectToSignIn() {
        // Show sign-up message for guest users
        const message = 'Please sign in to access your personalized dashboard with courses, progress tracking, and career recommendations.';
        
        if (confirm(message + '\n\nWould you like to sign in now?')) {
          window.location.href = '/signin.html?redirect=' + encodeURIComponent(window.location.pathname);
        } else {
          window.location.href = '/index.html';
        }
      }

      /**
       * Load all dashboard data
       */
      async loadDashboardData() {
        try {
          // Load user profile
          this.updateUserProfile();
          
          // Load dashboard stats
          await this.loadDashboardStats();
          
          // Load user courses
          await this.loadUserCourses();
          
          // Load recent activities
          await this.loadRecentActivities();
          
          // Load career recommendations
          await this.loadCareerRecommendations();
          
        } catch (error) {
          console.error('[PMERIT] Failed to load dashboard data:', error);
          this.showError('Failed to load dashboard data. Please refresh the page.');
        }
      }

      /**
       * Update user profile information
       */
      updateUserProfile() {
        if (!this.user) return;
        
        // Update welcome message
        document.getElementById('userName').textContent = this.user.name || 'Student';
        
        // Update profile section
        document.getElementById('profileName').textContent = this.user.name || 'Student';
        document.getElementById('profileEmail').textContent = this.user.email || '';
        document.getElementById('profileRole').textContent = this.user.role || 'Student';
        
        // Update avatar with initials
        const avatars = document.querySelectorAll('#userAvatar, #profileAvatar');
        const initials = this.getInitials(this.user.name || 'Student');
        avatars.forEach(avatar => {
          avatar.textContent = initials;
        });
      }

      /**
       * Load dashboard statistics
       */
      async loadDashboardStats() {
        try {
          const response = await fetch('/api/dashboard/stats', {
            credentials: 'include'
          });
          
          if (response.ok) {
            const stats = await response.json();
            
            document.getElementById('enrolledCourses').textContent = stats.enrolled_courses || 0;
            document.getElementById('completedCourses').textContent = stats.completed_courses || 0;
            document.getElementById('studyHours').textContent = stats.study_hours || 0;
            document.getElementById('certificatesEarned').textContent = stats.certificates || 0;
            document.getElementById('studyStreak').textContent = stats.study_streak || 0;
            
            // Update streak message
            const streakMessage = document.getElementById('streakMessage');
            if (stats.study_streak > 0) {
              streakMessage.textContent = `Great job! Keep up the momentum.`;
            } else {
              streakMessage.textContent = 'Start learning today to begin your streak!';
            }
            
          }
        } catch (error) {
          console.error('[PMERIT] Failed to load stats:', error);
        }
      }

      /**
       * Load user courses
       */
      async loadUserCourses() {
        try {
          const response = await fetch('/api/dashboard/courses', {
            credentials: 'include'
          });
          
          if (response.ok) {
            const courses = await response.json();
            this.renderCourses(courses);
          } else {
            this.showEmptyState('courses');
          }
        } catch (error) {
          console.error('[PMERIT] Failed to load courses:', error);
          this.showEmptyState('courses');
        }
      }

      /**
       * Render user courses
       */
      renderCourses(courses) {
        const container = document.getElementById('myCourses');
        const emptyState = document.getElementById('coursesEmptyState');
        
        if (!courses || courses.length === 0) {
          this.showEmptyState('courses');
          return;
        }
        
        container.innerHTML = '';
        emptyState.style.display = 'none';
        
        courses.forEach(course => {
          const courseCard = this.createCourseCard(course);
          container.appendChild(courseCard);
        });
      }

      /**
       * Create course card element
       */
      createCourseCard(course) {
        const card = document.createElement('div');
        card.className = 'course-card';
        card.addEventListener('click', () => {
          window.location.href = `/classroom.html?course=${course.id}`;
        });
        
        card.innerHTML = `
          <div class="course-header">
            <div class="course-icon">
              <i class="${course.icon || 'fas fa-book'}" aria-hidden="true"></i>
            </div>
            <div class="course-status status-${course.status || 'active'}">
              ${this.getStatusLabel(course.status)}
            </div>
          </div>
          <h4 class="course-title">${course.title}</h4>
          <p class="course-description">${course.description || 'Course description not available.'}</p>
          <div class="course-progress">
            <div class="progress-label">
              <span>Progress</span>
              <span>${course.progress || 0}%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: ${course.progress || 0}%"></div>
            </div>
          </div>
          <div class="course-actions">
            <button class="btn btn-sm btn-primary">Continue</button>
            <button class="btn btn-sm btn-outline">Details</button>
          </div>
        `;
        
        return card;
      }

      /**
       * Load recent activities
       */
      async loadRecentActivities() {
        try {
          const response = await fetch('/api/dashboard/activities', {
            credentials: 'include'
          });
          
          if (response.ok) {
            const activities = await response.json();
            this.renderActivities(activities);
          } else {
            this.showEmptyState('activities');
          }
        } catch (error) {
          console.error('[PMERIT] Failed to load activities:', error);
          this.showEmptyState('activities');
        }
      }

      /**
       * Render activities
       */
      renderActivities(activities) {
        const container = document.getElementById('recentActivities');
        const emptyState = document.getElementById('activitiesEmptyState');
        
        if (!activities || activities.length === 0) {
          this.showEmptyState('activities');
          return;
        }
        
        container.innerHTML = '';
        emptyState.style.display = 'none';
        
        activities.forEach(activity => {
          const activityItem = this.createActivityItem(activity);
          container.appendChild(activityItem);
        });
      }

      /**
       * Create activity item element
       */
      createActivityItem(activity) {
        const item = document.createElement('li');
        item.className = 'activity-item';
        
        item.innerHTML = `
          <div class="activity-icon">
            <i class="${activity.icon || 'fas fa-book'}" aria-hidden="true"></i>
          </div>
          <div class="activity-content">
            <div class="activity-title">${activity.title}</div>
            <div class="activity-time">${this.formatTime(activity.timestamp)}</div>
          </div>
        `;
        
        return item;
      }

      /**
       * Load career recommendations
       */
      async loadCareerRecommendations() {
        try {
          const response = await fetch('/api/dashboard/career-recommendations', {
            credentials: 'include'
          });
          
          if (response.ok) {
            const recommendations = await response.json();
            this.renderCareerRecommendations(recommendations);
          }
        } catch (error) {
          console.error('[PMERIT] Failed to load career recommendations:', error);
        }
      }

      /**
       * Render career recommendations
       */
      renderCareerRecommendations(recommendations) {
        const container = document.getElementById('careerRecommendations');
        const emptyState = document.getElementById('careersEmptyState');
        
        if (!recommendations || recommendations.length === 0) {
          emptyState.style.display = 'block';
          return;
        }
        
        emptyState.style.display = 'none';
        
        container.innerHTML = `
          <div class="career-recommendations">
            <p>Based on your assessment and learning progress, here are your top career matches:</p>
            <div class="recommendations-list">
              ${recommendations.slice(0, 3).map(rec => `
                <div class="recommendation-item">
                  <strong>${rec.title}</strong> - ${rec.compatibility}% match
                  <br><small>${rec.description}</small>
                </div>
              `).join('')}
            </div>
            <a href="/career.html" class="btn btn-sm btn-primary">View All Recommendations</a>
          </div>
        `;
      }

      /**
       * Show empty state for different sections
       */
      showEmptyState(section) {
        const containers = {
          'courses': 'myCourses',
          'activities': 'recentActivities'
        };
        
        const emptyStates = {
          'courses': 'coursesEmptyState',
          'activities': 'activitiesEmptyState'
        };
        
        if (containers[section]) {
          document.getElementById(containers[section]).innerHTML = '';
        }
        
        if (emptyStates[section]) {
          document.getElementById(emptyStates[section]).style.display = 'block';
        }
      }

      /**
       * Utility methods
       */
      getInitials(name) {
        return name
          .split(' ')
          .map(word => word.charAt(0))
          .join('')
          .toUpperCase()
          .slice(0, 2);
      }

      getStatusLabel(status) {
        const labels = {
          'active': 'In Progress',
          'completed': 'Completed',
          'paused': 'Paused',
          'not_started': 'Not Started'
        };
        return labels[status] || 'Active';
      }

      formatTime(timestamp) {
        if (!timestamp) return '';
        
        const date = new Date(timestamp);
        const now = new Date();
        const diff = now - date;
        
        const minutes = Math.floor(diff / (1000 * 60));
        const hours = Math.floor(diff / (1000 * 60 * 60));
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        
        if (minutes < 60) {
          return `${minutes} minutes ago`;
        } else if (hours < 24) {
          return `${hours} hours ago`;
        } else {
          return `${days} days ago`;
        }
      }

      showError(message) {
        console.error('[PMERIT] Dashboard error:', message);
        // Could implement a proper error UI here
      }
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => {
        new PMERITDashboard();
      });
    } else {
      new PMERITDashboard();
    }
  </script>

  <!-- Core JavaScript - Shared Assets -->
  <script src="/assets/nav-config.js"></script>
  <script src="/assets/boot-includes.js"></script>
</body>
</html>
