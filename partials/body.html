<!--
PMERIT AI PLATFORM: BODY PARTIAL NARRATIVE

This file defines the main three-panel estate layout for the core PMERIT student and guest experience, exclusive of the header and footer. It is meant to be injected into the <body> of main HTML templates (such as index.html, dashboard.html, assessment.html), and does not itself include <html>, <head>, or <body> tags.

SPECIFIC FUNCTION:
- Establishes the primary three-column responsive grid layout for the application: 
  - Left Sidebar (Quick Actions, Avatar, Brand, Dashboard)
  - Center Panel (AI chat, Virtual Human, dynamic learning content)
  - Right Panel (Support assistant, assessment cards, additional actions)

TEMPLATE-SPECIFIC CONSTRAINT:
- Contains only the body content of the estate, not the header or footer.
- Must be fully compatible with <!DOCTYPE html> pages, and styled to work with /assets/base.css and /assets/css/brand.css.
- Panels and UI blocks are organized for both desktop and mobile, using CSS grid: .estate { grid-template-columns: 280px 1fr 320px } and mobile breakpoint @media (max-width: 1100px) { grid-template-columns: 1fr }.

SPECIFIC REQUIREMENTS:
- Left Sidebar: 
  - Quick Actions (Virtual Human toggle, Career Track Explorer, Customer Service Mode)
  - Collapsible Settings (Dark Mode, TTS, Voice Preview)
  - Dashboard button (guest and authenticated state support)
  - Virtual Human avatar
  - PMERIT AI brand block with tagline
- Center Panel:
  - Badges for current AI mode (Virtual Human, Support Assistant)
  - AI Chat interface with message bubbles, input, and mode controls
  - Virtual Human stage for avatar/video and captions
- Right Panel:
  - Support Assistant prompt and mode toggles
  - "Discover Your Path" assessment cards (Learning Style, Interest Profiler, Skills Assessment), each with clear call-to-action buttons
- All icons use Font Awesome classes and are accessible via aria-labels.
- Main chat interface supports keyboard and screen reader navigation, including ARIA roles and live region updates for AI responses.
- All elements are styled with Inter, sans-serif and use design tokens from brand.css and base.css.
- Mobile: Panels collapse to a single column, sidebar and right panel become accordion or slide-out panels.
- All action buttons and toggles are large, accessible, and equipped with visible focus states.

INTEGRATION:
- This partial is loaded via boot-includes.js and is compatible with authenticated and guest user states.
- Interactive elements are wired to the PMERIT.api namespace for toggling modes, dashboard transitions, assessment initiation, and chat.
- Assessment CTAs are connected to the assessment system APIs (/api/assessment/start, etc).
- The layout and classes are designed for full DRY compatibility with PMERIT's CSS and JS template system.

RESULT:
- Delivers a flexible, accessible, and highly interactive estate layout that powers the PMERIT platform's main learning, support, and assessment journeys, supporting both desktop and mobile user experiences, while preserving the project's DRY, scalable frontend architecture.
-->

<div class="estate">
  <!-- Left Pane -->
  <aside id="left" aria-label="Quick actions sidebar">
    <section>
      <div class="pane-title">Quick Actions</div>

      <button class="toggle" id="vhToggle">
        <span><i class="fas fa-user-astronaut icon"></i> Virtual Human Mode</span>
        <span class="switch" aria-hidden="true"></span>
      </button>

      <button class="action" id="careerPaths">
        <span><i class="fas fa-compass icon"></i> Career Track & Explore Paths</span>
        <i class="fas fa-chevron-right" aria-hidden="true"></i>
      </button>

      <button class="toggle" id="supportToggle">
        <span><i class="fas fa-headset icon"></i> Customer Service Mode</span>
        <span class="switch" aria-hidden="true"></span>
      </button>

      <div class="collapsible" id="settingsBox">
        <div class="head">
          <strong><i class="fas fa-sliders-h"></i> Settings</strong>
          <i class="fas fa-chevron-down"></i>
        </div>
        <div class="body">
          <button class="toggle" id="darkToggle">
            <span><i class="fas fa-moon icon"></i> Dark Mode</span>
            <span class="switch" aria-hidden="true"></span>
          </button>
          <button class="toggle" id="ttsToggle">
            <span><i class="fas fa-volume-up icon"></i> Text-to-Speech</span>
            <span class="switch" aria-hidden="true"></span>
          </button>
          <button class="action" id="voicesBtn">
            <span><i class="fas fa-headphones icon"></i> Preview Voices</span>
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </div>

      <!-- Single Dashboard button -->
      <button class="dashboard guest" id="dashBtn">
        <i class="fas fa-gauge-high"></i> Dashboard
      </button>

      <div class="avatar" id="vhAvatar" title="Virtual Human">
        <i class="fas fa-user-circle" aria-hidden="true"></i>
      </div>
    </section>
  </aside>

  <!-- Center -->
  <main>
    <section class="panel" aria-label="Chat panel">
      <div class="panel-head">
        <div class="badges">
          <span class="badge vh" id="vhBadge" style="display:none">
            <i class="fas fa-user-astronaut"></i> Virtual Human
          </span>
          <span class="badge support" id="supportBadge" style="display:none">
            <i class="fas fa-headset"></i> Support Assistant
          </span>
        </div>
      </div>

      <div id="textChat" role="region" aria-live="polite">
        <div class="chat-body" id="chatBody">
          <article class="bubble" id="welcomeMsg">
            <div class="ava"><i class="fas fa-user-circle"></i></div>
            <div>
              <h3>PMERIT AI:</h3>
              <p id="welcomeCopy">Welcome to PMERIT! I'm here to guide your learning journey. Our mission is to provide accessible, high-quality education that opens doors to endless opportunities. How can I help you discover your potential today?</p>
            </div>
          </article>
        </div>
        <div class="chat-input">
          <textarea id="chatInput" maxlength="1000" placeholder="Ask about courses, learning paths, or your goals..." aria-label="Message"></textarea>
          <div class="input-bar">
            <span class="count" id="count">0/1000</span>
            <div class="input-actions">
              <button class="nav-btn" id="vhQuick">
                <i class="fas fa-user-astronaut"></i> VH Mode
              </button>
              <button class="nav-btn" id="readAbout">
                <i class="fas fa-book"></i> Read About
              </button>
              <span class="footer-status">
                <i class="fas fa-circle-check"></i> Connected to Educational Services
              </span>
            </div>
            <button class="send" id="sendBtn">Send <i class="fas fa-paper-plane"></i></button>
          </div>
        </div>
      </div>

      <!-- Virtual Human stage -->
      <div id="vhStage" role="region" aria-live="polite">
        <div class="stage">
          <div class="human-frame">
            <div class="human-face"><i class="fas fa-user-circle"></i></div>
          </div>
        </div>
        <div class="captions" id="captions">Virtual Human is speaking…</div>
      </div>
    </section>

    <!-- Mobile accordions -->
    <div id="mobileAccordions" aria-label="Mobile sections">
      <details class="mobile-accordion">
        <summary><i class="fas fa-bolt"></i> Quick Actions - Tap to expand ▼</summary>
        <div class="mobile-accordion-content">
          <div class="mobile-grid">
            <button class="mobile-card" id="m_vhToggle">
              <i class="fas fa-user-astronaut"></i>
              <span>Virtual Human</span>
              <div class="switch"></div>
            </button>
            <button class="mobile-card" id="m_careerPaths">
              <i class="fas fa-compass"></i>
              <span>Career Paths</span>
            </button>
            <button class="mobile-card" id="m_supportToggle">
              <i class="fas fa-headset"></i>
              <span>Support Mode</span>
              <div class="switch"></div>
            </button>
            <button class="mobile-card" id="m_settings">
              <i class="fas fa-cog"></i>
              <span>Settings</span>
            </button>
          </div>
          <button class="dashboard guest nav-btn" id="m_dashBtn" style="margin-top:1rem;width:100%">
            <i class="fas fa-gauge-high"></i> Dashboard
          </button>
        </div>
      </details>

      <details class="mobile-accordion">
        <summary><i class="fas fa-graduation-cap"></i> Discover Your Path - Tap to expand ▼</summary>
        <div class="mobile-accordion-content">
          <div class="discover" style="margin:0">
            <h4>Personalized learning plan</h4>
            <p>Start a short flow that blends learning style, interests, and skills into a plan.</p>
            <button class="nav-btn primary" id="m_beginAssessment">Begin Assessment</button>
            <div class="insights" id="m_insights">Tip: Short, daily practice beats long, rare sessions.</div>
          </div>
        </div>
      </details>
    </div>
  </main>

  <!-- Right Pane -->
  <aside id="right" aria-label="Support and discover sidebar">
    <section>
      <div class="support-assistant">
        <h4><i class="fas fa-headset"></i> Support Assistant</h4>
        <p style="color: var(--text-secondary); margin: 0.5rem 0;">Ask me about PMERIT</p>
        <div style="display:flex;gap:.5rem;justify-content:center;margin-top:.75rem">
          <button class="nav-btn" style="border-color:var(--accent)" id="vhShort">
            <i class="fas fa-user-astronaut"></i> Virtual Human
          </button>
          <button class="nav-btn" style="border-color:var(--success)" id="supportShort">
            <i class="fas fa-headset"></i> Support
          </button>
        </div>
      </div>

      <h3>Discover Your Path (AI)</h3>
      <div class="discover">
        <h4>Personalized learning plan</h4>
        <p>Start a short flow that blends learning style, interests, and skills into a plan.</p>
        <button class="nav-btn primary" id="beginAssessment">Begin Assessment</button>
        <div class="insights" id="insights">Pro tip: Keep notes in your own words for better recall.</div>
      </div>
    </section>
  </aside>
</div>
