<nav class="sidebar" role="navigation" aria-label="Main navigation">
  <!-- Quick Actions Section -->
  <section class="nav-section">
    <header class="nav-section-header">
      <h3>
        <i class="fas fa-bolt" aria-hidden="true"></i>
        Quick Actions
      </h3>
    </header>
    
    <div class="nav-actions">
      <button class="nav-action-btn" id="vhToggleBtn" type="button" aria-describedby="vhToggleDesc">
        <div class="action-icon">
          <i class="fas fa-user-astronaut" aria-hidden="true"></i>
        </div>
        <div class="action-content">
          <span class="action-title">Virtual Human Mode</span>
          <span class="action-subtitle">Immersive AI experience</span>
        </div>
        <div class="action-toggle">
          <div class="toggle-switch" role="switch" aria-checked="false" aria-labelledby="vhToggleBtn">
            <div class="toggle-indicator"></div>
          </div>
        </div>
      </button>
      <div id="vhToggleDesc" class="sr-only">Toggle virtual human mode for immersive learning</div>

      <button class="nav-action-btn" id="careerPathsBtn" type="button">
        <div class="action-icon">
          <i class="fas fa-compass" aria-hidden="true"></i>
        </div>
        <div class="action-content">
          <span class="action-title">Career Track & Explore Paths</span>
          <span class="action-subtitle">Discover career opportunities</span>
        </div>
        <div class="action-indicator">
          <i class="fas fa-chevron-right" aria-hidden="true"></i>
        </div>
      </button>

      <button class="nav-action-btn" id="customerServiceToggle" type="button" aria-describedby="customerServiceDesc">
        <div class="action-icon">
          <i class="fas fa-headset" aria-hidden="true"></i>
        </div>
        <div class="action-content">
          <span class="action-title">Customer Service Mode</span>
          <span class="action-subtitle">AI support assistance</span>
        </div>
        <div class="action-toggle">
          <div class="toggle-switch" role="switch" aria-checked="false" aria-labelledby="customerServiceToggle">
            <div class="toggle-indicator"></div>
          </div>
        </div>
      </button>
      <div id="customerServiceDesc" class="sr-only">Toggle customer service mode for platform support</div>
    </div>
  </section>
  <!-- begining of new Settings Section -->
  <!-- ==============================================
     PMERIT Settings Section - Fixed HTML Structure  
     Use this structure in partials/nav.html
     ============================================== -->

<!-- Settings Section with Proper Collapsible Structure -->
<section class="nav-section" aria-labelledby="settings-heading">
  <details class="nav-dropdown" id="settingsDropdown">
    <summary class="nav-dropdown-toggle" id="settings-heading" role="button" aria-expanded="false">
      <div class="dropdown-icon">
        <i class="fas fa-cog" aria-hidden="true"></i>
      </div>
      <span class="dropdown-title">Settings</span>
      <div class="dropdown-arrow">
        <i class="fas fa-chevron-down" aria-hidden="true"></i>
      </div>
    </summary>
    
    <div class="nav-dropdown-content" role="region" aria-labelledby="settings-heading">
      
      <!-- Language Selection -->
      <div class="setting-item">
        <label for="languageSelect" class="setting-label">
          <i class="fas fa-globe" aria-hidden="true"></i>
          <span>Language</span>
        </label>
        <div class="setting-control">
          <select id="languageSelect" class="form-control" aria-label="Select language">
            <option value="en">English</option>
            <option value="yo">Yorùbá</option>
            <option value="ig">Igbo</option>
            <option value="ha">Hausa</option>
            <option value="sw">Swahili</option>
            <option value="fr">Français</option>
            <option value="es">Español</option>
          </select>
        </div>
      </div>

      <!-- Dark Mode Toggle -->
      <div class="setting-item">
        <label for="darkModeSwitch" class="setting-label">
          <i class="fas fa-moon" aria-hidden="true"></i>
          <span>Dark Mode</span>
        </label>
        <div class="setting-control">
          <button type="button" 
                  class="switch" 
                  id="darkModeSwitch" 
                  role="switch" 
                  aria-checked="false"
                  aria-label="Toggle dark mode">
            <span class="sr-only">Toggle dark mode</span>
          </button>
        </div>
      </div>

      <!-- Text-to-Speech Toggle -->
      <div class="setting-item">
        <label for="ttsSwitch" class="setting-label">
          <i class="fas fa-volume-up" aria-hidden="true"></i>
          <span>Text-to-Speech</span>
        </label>
        <div class="setting-control">
          <button type="button" 
                  class="switch" 
                  id="ttsSwitch" 
                  role="switch" 
                  aria-checked="false"
                  aria-label="Toggle text-to-speech">
            <span class="sr-only">Toggle text-to-speech</span>
          </button>
        </div>
      </div>

      <!-- Voice Preview Button -->
      <div class="setting-item">
        <button type="button" class="setting-action" id="voicesBtn" aria-label="Preview available voices">
          <div class="setting-label">
            <i class="fas fa-headphones" aria-hidden="true"></i>
            <span>Preview Voices</span>
          </div>
          <div class="setting-arrow">
            <i class="fas fa-chevron-right" aria-hidden="true"></i>
          </div>
        </button>
      </div>

      <!-- Notification Settings -->
      <div class="setting-item">
        <label for="notificationSwitch" class="setting-label">
          <i class="fas fa-bell" aria-hidden="true"></i>
          <span>Notifications</span>
        </label>
        <div class="setting-control">
          <button type="button" 
                  class="switch" 
                  id="notificationSwitch" 
                  role="switch" 
                  aria-checked="true"
                  aria-label="Toggle notifications">
            <span class="sr-only">Toggle notifications</span>
          </button>
        </div>
      </div>

      <!-- Auto-Save Settings -->
      <div class="setting-item">
        <label for="autoSaveSwitch" class="setting-label">
          <i class="fas fa-save" aria-hidden="true"></i>
          <span>Auto-Save Progress</span>
        </label>
        <div class="setting-control">
          <button type="button" 
                  class="switch active" 
                  id="autoSaveSwitch" 
                  role="switch" 
                  aria-checked="true"
                  aria-label="Toggle auto-save">
            <span class="sr-only">Toggle auto-save</span>
          </button>
        </div>
      </div>

    </div>
  </details>
</section>

<!-- Alternative: If <details> doesn't work, use this div-based structure -->
<!--
<section class="nav-section" aria-labelledby="settings-heading-alt">
  <div class="nav-dropdown" id="settingsDropdownAlt">
    <button type="button" class="nav-dropdown-toggle" id="settings-heading-alt" aria-expanded="false">
      <div class="dropdown-icon">
        <i class="fas fa-cog" aria-hidden="true"></i>
      </div>
      <span class="dropdown-title">Settings</span>
      <div class="dropdown-arrow">
        <i class="fas fa-chevron-down" aria-hidden="true"></i>
      </div>
    </button>
    
    <div class="nav-dropdown-content" 
         role="region" 
         aria-labelledby="settings-heading-alt"
         style="display: none;">
      
      [Same content as above]
      
    </div>
  </div>
</section>
-->

<style>
/* Additional CSS for setting-action buttons */
.setting-action {
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: transparent;
  border: none;
  padding: 0;
  cursor: pointer;
  transition: background-color 0.2s ease;
  border-radius: var(--radius-md, 0.375rem);
}

.setting-action:hover {
  background-color: var(--bg-secondary, #F8FAFC);
}

.setting-action:focus {
  outline: none;
  background-color: var(--bg-secondary, #F8FAFC);
  box-shadow: 0 0 0 2px var(--primary, #4F46E5);
}

.setting-arrow {
  color: var(--text-tertiary, #94A3B8);
  transition: color 0.2s ease;
}

.setting-action:hover .setting-arrow {
  color: var(--primary, #4F46E5);
}

.dark .setting-action:hover,
.dark .setting-action:focus {
  background-color: var(--bg-tertiary, #334155);
}

/* Custom select styling */
.setting-control select.form-control {
  padding: var(--space-1, 0.25rem) var(--space-2, 0.5rem);
  font-size: var(--font-size-xs, 0.75rem);
  border-radius: var(--radius-md, 0.375rem);
  border: 1px solid var(--border-color, #E5E7EB);
  background-color: var(--card-bg, #FFFFFF);
  color: var(--text-primary, #1F2937);
  cursor: pointer;
}

.setting-control select.form-control:focus {
  border-color: var(--primary, #4F46E5);
  box-shadow: 0 0 0 1px var(--primary, #4F46E5);
}

.dark .setting-control select.form-control {
  background-color: var(--bg-tertiary, #334155);
  border-color: var(--border-dark, #475569);
  color: var(--text-primary, #F1F5F9);
}
</style>

<script>
// Enhanced JavaScript for this specific structure
document.addEventListener('DOMContentLoaded', function() {
  const settingsDropdown = document.getElementById('settingsDropdown');
  const settingsToggle = document.getElementById('settings-heading');
  
  if (settingsDropdown && settingsToggle) {
    // Update aria-expanded when details state changes
    settingsDropdown.addEventListener('toggle', function() {
      const isOpen = this.open;
      settingsToggle.setAttribute('aria-expanded', isOpen.toString());
      
      // Update switch states based on localStorage
      updateSwitchStates();
    });
    
    // Function to update switch states
    function updateSwitchStates() {
      // Dark mode
      const darkModeSwitch = document.getElementById('darkModeSwitch');
      const isDarkMode = localStorage.getItem('pmerit_dark_mode') === 'true';
      if (darkModeSwitch) {
        darkModeSwitch.classList.toggle('active', isDarkMode);
        darkModeSwitch.setAttribute('aria-checked', isDarkMode.toString());
      }
      
      // TTS
      const ttsSwitch = document.getElementById('ttsSwitch');
      const isTTSEnabled = localStorage.getItem('pmerit_tts') === 'true';
      if (ttsSwitch) {
        ttsSwitch.classList.toggle('active', isTTSEnabled);
        ttsSwitch.setAttribute('aria-checked', isTTSEnabled.toString());
      }
      
      // Notifications (default true)
      const notificationSwitch = document.getElementById('notificationSwitch');
      const areNotificationsEnabled = localStorage.getItem('pmerit_notifications') !== 'false';
      if (notificationSwitch) {
        notificationSwitch.classList.toggle('active', areNotificationsEnabled);
        notificationSwitch.setAttribute('aria-checked', areNotificationsEnabled.toString());
      }
    }
    
    // Initialize switch states
    updateSwitchStates();
  }
});
</script>
  <!-- end of new Settings Section -->
  <!-- Settings Section -->
 <!-- <section class="nav-section">
    <header class="nav-section-header">
      <h3>
        <i class="fas fa-cog" aria-hidden="true"></i>
        Settings
      </h3>
      <button class="section-toggle" aria-expanded="true" aria-controls="settingsContent">
        <i class="fas fa-chevron-down" aria-hidden="true"></i>
      </button>
    </header>
    
    <div class="nav-content" id="settingsContent">
      <div class="setting-item">
        <label class="setting-label">
          <input type="checkbox" id="darkModeToggle" class="setting-checkbox">
          <span class="setting-text">Dark Mode</span>
        </label>
      </div>
      
      <div class="setting-item">
        <label class="setting-label">
          <input type="checkbox" id="ttsToggle" class="setting-checkbox">
          <span class="setting-text">Text-to-Speech</span>
        </label>
      </div>
    </div>
  </section>-->

  <!-- Navigation Section -->
  <section class="nav-section">
    <header class="nav-section-header">
      <h3>
        <i class="fas fa-compass" aria-hidden="true"></i>
        Navigation
      </h3>
      <button class="section-toggle" aria-expanded="true" aria-controls="navigationContent">
        <i class="fas fa-chevron-down" aria-hidden="true"></i>
      </button>
    </header>
    
    <div class="nav-content" id="navigationContent">
      <ul class="nav-menu">
        <li class="nav-item">
          <button class="nav-link" id="dashboardBtn" type="button">
            <i class="fas fa-tachometer-alt" aria-hidden="true"></i>
            Dashboard
          </button>
        </li>
        <li class="nav-item">
          <a href="/courses.html" class="nav-link">
            <i class="fas fa-book-open" aria-hidden="true"></i>
            My Courses
          </a>
        </li>
        <li class="nav-item">
          <a href="/library.html" class="nav-link">
            <i class="fas fa-university" aria-hidden="true"></i>
            Library
          </a>
        </li>
        <li class="nav-item">
          <a href="/career.html" class="nav-link">
            <i class="fas fa-briefcase" aria-hidden="true"></i>
            Career Center
          </a>
        </li>
      </ul>

      <!-- User Status -->
      <div class="nav-user-status">
        <div class="user-tier">
          <i class="fas fa-graduation-cap" aria-hidden="true"></i>
          <span>Student</span>
        </div>
        <div class="plan-status">
          <i class="fas fa-star" aria-hidden="true"></i>
          <span>Free Plan</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Help & Support Section -->
  <section class="nav-section">
    <header class="nav-section-header">
      <h3>
        <i class="fas fa-life-ring" aria-hidden="true"></i>
        Help & Support
      </h3>
    </header>
    
    <div class="nav-actions">
      <button class="nav-action-btn support-btn" id="helpCenterBtn" type="button">
        <div class="action-icon">
          <i class="fas fa-question-circle" aria-hidden="true"></i>
        </div>
        <div class="action-content">
          <span class="action-title">Help Center</span>
        </div>
      </button>

      <button class="nav-action-btn support-btn" id="sendFeedbackBtn" type="button">
        <div class="action-icon">
          <i class="fas fa-comment-alt" aria-hidden="true"></i>
        </div>
        <div class="action-content">
          <span class="action-title">Send Feedback</span>
        </div>
      </button>
    </div>
  </section>

  <!-- Footer Status -->
  <div class="nav-footer">
    <div class="connection-status">
      <i class="fas fa-circle-check" aria-hidden="true"></i>
      <span>Connected to Educational Services</span>
    </div>
    <div class="system-info">
      <small>Database: <span class="status-indicator online">●</span> Online</small>
      <small>AI Services: <span class="status-indicator online">●</span> Available</small>
      <small>Assessment API: <span class="status-indicator online">●</span> Ready</small>
      <small>Job Market Data: <span class="status-indicator online">●</span> Updated</small>
    </div>
  </div>
</nav>
