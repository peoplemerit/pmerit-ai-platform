****See "PMERIT Frontend Integration Patch - Ongoing Plan_vs2.txt", the frontend document as a Patch to this document.
***

### **PMERIT AI Educational Platform - Master Document (Integrated & Restructured)**

**Document Version:** 2.1
**Status:** Comprehensive Blueprint (Corrected)

---

### **1.0 Core Mission & Philosophical Foundation**
*   **Primary Mission:** To break cycles of poverty by providing accessible, high-quality education to underserved learners globally.
*   **Guiding Principle:** Founded on the biblical principle: "My people perish for a lack of knowledge" (Hosea 4:6).
*   **Revenue Philosophy:** Education must liberate, not indebt. The model is built on the principle that those who can pay will subsidize those who cannot, ensuring knowledge is never paywalled.

### **2.0 Strategic Objectives**
#### **2.1 Global Educational Access**
*   **Target Audience:** Underserved learners across Africa, South Asia, Latin America, and rural communities worldwide.
*   **Value Proposition:** Provide free, practical, high-quality education that leads directly to employment and economic empowerment.

#### **2.2 Dual-Market Launch Strategy**
*   **Primary Market (Nigeria & US):** 200M+ population, cultural familiarity, and direct integration with NBS/BLS job market data.
*   **Secondary Market (US):** Focus on rural communities, veterans, displaced workers, and underserved populations.
*   **Future Goal:** A scalable model for worldwide deployment.

#### **2.3 Technology-Enabled Learning**
*   **AI-Powered Tutoring:** Personalized learning using Phi-3, Mistral models, and a rule-based expert system.
*   **Accessibility:** Mobile-first design optimized for budget devices and 3G connectivity.
*   **Inclusivity:** Offline capabilities and multi-language support (English, Yoruba, Igbo, Hausa, Spanish).

#### **2.4 Career-Focused Outcomes**
*   **Market Alignment:** Integration with Nigerian Bureau of Statistics (NBS) and US Bureau of Labor Statistics (BLS) for real-time job market data.
*   **Career Services:** AI-powered career guidance, job matching, and a freelance marketplace for immediate income opportunities.

#### **2.5 AI-Powered Discovery & Assessment System**
*   **Personality & Workstyle Profile:** AI-driven assessment based on the Big Five (OCEAN) model to recommend optimal learning styles and career paths.
*   **Interest Profiler:** Maps user interests to NBS/BLS job market data to recommend viable Career Tracks.
*   **Skills Gap Assessment:** Provides a diagnostic of a user's current readiness and a personalized starting point within a learning path.

#### **2.6 Educational Service Tracks & Curriculum Strategy**
The platform is structured around three distinct service tracks to meet specific audience needs.

*   **A. Global Remote Career (GRC) Track**
    *   **Focus:** Digital skills for remote and international employment.
    *   **Target:** Users seeking opportunities in the global digital economy.
    *   **Sample Courses:** Digital Marketing, Software Development, Data Analysis, Project Management.

*   **B. Local Career Pathways (LCP) Track**
    *   **Focus:** Vocational skills for local employment and entrepreneurship.
    *   **Target:** Individuals seeking to enter or advance within their local job market.
    *   **Sample Courses:** Agricultural Technology, Small Business Management, Healthcare Support, Construction Trades.
    *   **Integration:** Directly aligned with real-time NBS and BLS/Burning Glass labor market data.

*   **C. Local Education (LEd) Track**
    *   **Focus:** Supporting formal education from Nursery through College.
    *   **Target:** Students within Nigerian and U.S. school systems.
    *   **Core Value:** Augments local curricula with AI-powered tutoring and career-aligned electives.
    *   **Structured Levels:**
        *   **Nursery & Primary:** Foundational literacy, numeracy, and digital readiness.
        *   **Secondary:** STEM, Humanities, Career preparation, and Entrepreneurship.
        *   **College Bridge:** Specialized tracks aligned to GRC and LCP courses for advanced study.

### **3.0 Technical Architecture & Functional Requirements**
#### **3.1 Core Platform Features**
*   **User Management:** Multi-tier authentication (Basic/Premium/Enterprise), role-based access control (Students, Instructors, Admins).
*   **Content Delivery:** Structured learning paths, interactive assessments, real-time progress tracking.
*   **Credentialing:** Blockchain-verified certificate generation.
*   **Content Development:** No-code course builder for administrators and educators.

#### **3.2 AI Integration Specifications ("PMERIT AI Tutor")**
*   **Foundation Model:** Rule-based expert system for contextual guidance.
*   **Advanced AI Tutoring:** Cloud LLM integration for personalized Q&A, adaptive learning paths, and progress assessment.
*   **RAG System:** Vector database with course materials for enhanced, curriculum-grounded responses.
*   **Grading Automation:** Self-hosted custom algorithms for most assessments with GPT-4 for complex assignments (premium feature).

#### **3.3 AI-Tutored Academic System: Database Architecture**
The platform is architected as a complete digital university powered by a structured database.
*   **Tier 4A: Administrative Management:** `admin_users`, `system_config`, `support_tickets`, `audit_logs`.
*   **Tier 4B: Curriculum Management:** `curriculums`, `curriculum_courses`, `course_prerequisites`.
*   **Tier 4C: AI Teaching Materials:** `ai_teaching_materials`, `multimodal_content` (for voice, images in multiple languages).
*   **Tier 4D: AI Tutoring Intelligence:** `ai_tutor_personalities`, `student_learning_profiles`, `adaptive_learning_paths`.

#### **3.4 Virtual Human Interface**
*   **Purpose:** Branded, interactive avatar for immersive student interaction and customer support.
*   **Features:** Voice-based conversation, cultural representation, image analysis for educational content.

#### **3.5 Multimedia Processing**
*   **Text-to-Speech (TTS):** Voice cloning, emotion control, support for local accents. Privacy-focused with local processing.
*   **Speech-to-Text (STT):** Real-time transcription using Whisper.cpp.

#### **3.6 Integrity & Fairness**
*   **Anti-Cheating:** Escalating hints system, plagiarism detection, CodeOcean integration for programming validation.
*   **Bias Mitigation:** Integrated tools: IBM AIF360, Fairlearn.

### **4.0 Sustainable Revenue Model Architecture**
#### **4.1 Refined "Pay for Failure" Model**
*   **Philosophy:** Creates accountability without blocking access.
*   **Structure:**
    *   First attempt: **FREE**
    *   Second attempt: **FREE** (with mandatory tutoring)
    *   Third attempt: Small fee ($0.50 - covers platform costs)
    *   Additional attempts: Graduated fee ($1, $2, etc.)
    *   **Exemptions:** Technical failures, documented hardships, completion of remedial activities.

#### **4.2 Multi-Stream Revenue Strategy**
*   **The "Ubuntu Model" (Community):** Pay-It-Forward system where successful graduates contribute voluntarily.
*   **Corporate Sponsorship Tiers:** Village Sponsor ($1k/mo), Regional Sponsor ($5k/mo), National Partner ($20k/mo).
*   **Freemium Education:**
    *   **Free Forever:** All course content, basic AI tutoring, community forums.
    *   **Premium Acceleration ($2.99/mo):** Advanced AI, personalized paths, mentor sessions.
    *   **Enterprise Platform ($500-$5k/mo):** White-label solutions, custom curriculum, API access.
*   **Certification & Validation:**
    *   Completion Certificate: **Free**
    *   Verified Certificate: **$5** (Blockchain-verified)
    *   Professional Certification: **$25** (Industry-recognized, proctored)
*   **Marketplace Model:** Platform-hosted services with an 80/20 revenue split for providers.
*   **Ethical Data Monetization (B2B/Government):** Sale of fully anonymized skills gap analysis and workforce readiness reports.
*   **Grants & Donations:** Targeted grants from major foundations with crypto and micro-donation options.

#### **4.3 Revenue Projections**
*   **Year 1 (Conservative):** $280,000 (10k users, 5% paying)
*   **Year 2 (Growth):** $950,000 (100k users, 5% paying + corporate clients)
*   **Year 3 (Scale):** $3,500,000 (500k users, 5% paying + 50 corporate clients)

### **5.0 Front-Facing Platform Requirements & System Capabilities**
#### **5.1 Front Page UI Component Requirements**
*   **Authentication-Aware UI:** A single "Dashboard" button triggers sign-up for guests and proceeds to dashboard.html for authenticated users.
*   **Dynamic Left Pane:** Contains Virtual Human Toggle, Career Track Explorer, **Customer Service Mode Toggle**, and Settings (Dark Mode, TTS).
*   **Central AI Chat Pane:** Branded "PMERIT AI" with mode indicators, character counter, and TTS functionality.
*   **Assessment Discovery Pane:** Houses three AI-powered assessment cards (Personality, Interest, Skills) with "Start Assessment" CTAs.

#### **5.2 AI System Capability Requirements**
*   **Dual-Purpose AI System:**
    *   **Educational Tutor Mode (Default):** Uses educational RAG for teaching and Socratic questioning.
    *   **Customer Service Mode:** Uses a separate support RAG index to handle account, technical, and platform queries.
*   **Integrated Assessment Engine:** Powers conversational, dynamic assessments for personality, interests, and skills gaps.

#### **5.3 User Journey Integration**
*   **Guest ‚Üí Registered Learner:** Guests can take assessments; results are cached and saved upon registration. Seamless transition to a personalized dashboard.
*   **Admin Tiers:** Tier 1 (Strategic) and Tier 2 (Operational) admins manage curriculum, enrollments, and system oversight via no-code tools.

### **6.0 Implementation Roadmap & Ethical Framework**
#### **6.1 Immediate Technical Actions**
*   Update homepage UI to be authentication-aware.
*   Implement Virtual Human, Career Track JSON, and Customer Service mode toggles.
*   Set up local storage for session management.

#### **6.2 Immediate Revenue Actions**
*   Launch with a Donation-First model to build trust.
*   Fast-Track B2B pilot programs with Nigerian companies.
*   Phased Monetization over 12 months (Free ‚Üí Certificates ‚Üí Premium ‚Üí Enterprise).

#### **6.3 Ethical Framework**
*   **Always Free:** Core education content, basic platform access, community support, first attempt at any course.
*   **Never Compromise:** Paywalling knowledge, selling user data, creating debt traps, or favoring wealthy students.


Of course. I will restructure, organize, and align your infrastructure plan. The core changes will be:
1.  **Removing all Oracle components** and replacing them with a **local PostgreSQL** database running in Docker.
2.  **Replacing ORDS** with a dedicated **API service** (like Node.js/Express or Python/FastAPI) to handle business logic and communicate with Postgres.
3.  **Integrating** this new API service into the Docker compose setup and Cloudflare Tunnel routing.
4.  **Updating all scripts, diagrams, and descriptions** to reflect the new, fully self-contained architecture.

Here is the reorganized and accurate plan.

---

### **Ongoing Plan for Pmerit Infrastructure (PostgreSQL Edition)**
**Current Phase:** HP Host, Docker Stack, Portable HDD/SSD
**Core Principle:** Complete Portability & Self-Containment. The entire infrastructure, including the database, can be moved with the portable drive.

### **Element 0 ‚Äî Big Picture (What Runs Where)**
```mermaid
graph TD
    Browser["Web Browser"] --> HTTPS
    HTTPS --> Pages["Cloudflare Pages<br>(Frontend Static Site)"]
    Pages -->|fetch| Worker["Cloudflare Worker<br>(API Gateway / Proxy)"]

    Worker -->|API Calls| Tunnel[Cloudflare Tunnel]
    Worker -->|API Calls| Tunnel

    Tunnel -->|Routes traffic to| Docker["HP: Docker Stack"]
    
    subgraph Docker [Portable Docker Infrastructure]
        API[API Service<br>Node.js/Python]
        API --> Postgres["PostgreSQL<br>(Primary Database)"]
        Syncthing[Syncthing<br>(Files Sync)]
        Ollama[Ollama<br>(Phi-3 + Mistral)]
    end

    Tunnel -.-> API
    Tunnel -.-> Syncthing
```
**Why this fits Pmerit:** The frontend (Pages) and edge logic (Worker) remain serverless and scalable. The entire backend state (Database, AI Models, File Storage, Configs) is now portable within the Docker stack on your HDD/SSD. Unplug the drive and run it anywhere with Docker.

### **Element 1 ‚Äî Portable Folder on the HDD/SSD**
```
/pmerit/
‚îî‚îÄ‚îÄ infra_portable/
    ‚îú‚îÄ‚îÄ compose.yaml                 # Master Docker Compose file
    ‚îú‚îÄ‚îÄ .env                        # Real secrets (NOT checked into git)
    ‚îú‚îÄ‚îÄ .env.example                # Template for .env
    ‚îú‚îÄ‚îÄ api/                        # NEW: API Service Code
    ‚îÇ   ‚îú‚îÄ‚îÄ src/
    ‚îÇ   ‚îú‚îÄ‚îÄ package.json
    ‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt
    ‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
    ‚îú‚îÄ‚îÄ data/
    ‚îÇ   ‚îú‚îÄ‚îÄ postgres/               # NEW: PostgreSQL database files
    ‚îÇ   ‚îú‚îÄ‚îÄ syncthing/
    ‚îÇ   ‚îú‚îÄ‚îÄ cloudflared/
    ‚îÇ   ‚îî‚îÄ‚îÄ ollama/
    ‚îú‚îÄ‚îÄ scripts/
    ‚îÇ   ‚îú‚îÄ‚îÄ bootstrap.sh            # Setup script for a new machine
    ‚îÇ   ‚îú‚îÄ‚îÄ pull_models.sh          # Pull Ollama models
    ‚îÇ   ‚îú‚îÄ‚îÄ backup_database.sh      # NEW: Backup PostgreSQL
    ‚îÇ   ‚îú‚îÄ‚îÄ backup_cloudflare.sh    # Backup Worker/Pages config
    ‚îÇ   ‚îú‚îÄ‚îÄ backup_models.sh        # Backup Ollama models
    ‚îÇ   ‚îî‚îÄ‚îÄ snapshot_configs.sh     # Backup all configs
    ‚îî‚îÄ‚îÄ systemd/
        ‚îî‚îÄ‚îÄ pmerit-compose.service  # Systemd service file
```
*Everything is relative to this folder ‚áí perfectly portable.*

### **Element 2 ‚Äî .env.example (Copy to .env and fill)**
```ini
# General
TZ=UTC
PUID=1000
PGID=1000
DATA_DIR=./data

# Syncthing
SYNCTHING_GUI_PORT=8384

# Cloudflared
CLOUDFLARED_TUNNEL_TOKEN=replace_me

# Ollama / AI
OLLAMA_PORT=11434
OLLAMA_NUM_PARALLEL=1
AI_PUBLIC_HOST=ai.pmerit.example

# API Service
API_PORT=3000
API_HOST=api.pmerit.example

# PostgreSQL Database - NEW
POSTGRES_DB=pmeritdb
POSTGRES_USER=pmerit
POSTGRES_PASSWORD=replace_me_with_strong_password
POSTGRES_PORT=5432
PGDATA=/var/lib/postgresql/data
```

### **Element 3 ‚Äî compose.yaml (Syncthing + Cloudflared + Ollama + PostgreSQL + API Service)**
```yaml
version: '3.8'

services:
  # NEW: PostgreSQL Database
  postgres:
    image: postgres:15
    container_name: postgres
    restart: unless-stopped
    environment:
      POSTGRES_DB: ${POSTGRES_DB}
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      PGDATA: ${PGDATA}
      TZ: ${TZ}
    volumes:
      - ${DATA_DIR}/postgres:${PGDATA} # Database data lives on HDD
    ports:
      - "127.0.0.1:${POSTGRES_PORT}:5432" # Exposed only locally
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ${POSTGRES_USER}"]
      interval: 10s
      timeout: 5s
      retries: 5
    security_opt:
      - no-new-privileges:true
    read_only: true
    tmpfs:
      - /tmp
    networks:
      - pmerit-net

  # NEW: API Service
  api:
    build: ./api # Builds from the ./api/Dockerfile
    container_name: api
    restart: unless-stopped
    environment:
      NODE_ENV: production
      DATABASE_URL: postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}
      TZ: ${TZ}
    ports:
      - "127.0.0.1:${API_PORT}:3000" # Exposed locally for the tunnel
    depends_on:
      postgres:
        condition: service_healthy
    security_opt:
      - no-new-privileges:true
    read_only: true
    tmpfs:
      - /tmp
      - /app/node_modules/.tmp # If using Node
    networks:
      - pmerit-net

  # Existing Services
  syncthing:
    image: syncthing/syncthing:1.27
    container_name: syncthing
    restart: unless-stopped
    user: "${PUID}:${PGID}"
    environment: [PUID=${PUID}, PGID=${PGID}, TZ=${TZ}]
    volumes:
      - ${DATA_DIR}/syncthing/config:/var/syncthing/config
      - ${DATA_DIR}/syncthing/data:/var/syncthing/data
      - ../pmerit_project:/var/syncthing/data/pmerit_project
    ports:
      - "127.0.0.1:${SYNCTHING_GUI_PORT}:8384"
    security_opt: [no-new-privileges:true]
    read_only: true
    tmpfs: [/tmp]
    networks:
      - pmerit-net

  cloudflared:
    image: cloudflare/cloudflared:2025.6.1
    container_name: cloudflared
    restart: unless-stopped
    command: tunnel --no-autoupdate run --token ${CLOUDFLARED_TUNNEL_TOKEN}
    volumes:
      - ${DATA_DIR}/cloudflared:/etc/cloudflared
    security_opt: [no-new-privileges:true]
    read_only: true
    tmpfs: [/tmp]
    networks:
      - pmerit-net

  ollama:
    image: ollama/ollama:latest
    container_name: ollama
    restart: unless-stopped
    environment: [OLLAMA_NUM_PARALLEL=${OLLAMA_NUM_PARALLEL}, TZ=${TZ}]
    volumes:
      - ${DATA_DIR}/ollama:/root/.ollama
    ports:
      - "127.0.0.1:${OLLAMA_PORT}:11434"
    healthcheck:
      test: ["CMD", "curl", "-fsS", "http://127.0.0.1:11434/api/tags"]
      interval: 15s
      timeout: 5s
      retries: 20
    security_opt: [no-new-privileges:true]
    read_only: true
    tmpfs: [/tmp]
    networks:
      - pmerit-net

networks:
  pmerit-net:
    name: pmerit-network
    driver: bridge
```

### **Element 4 ‚Äî API Service Example (Node.js)**
**`./api/Dockerfile`**
```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY src/ ./src/
USER node
EXPOSE 3000
CMD ["node", "src/index.js"]
```

**`./api/src/index.js` (Simplified Example)**
```javascript
const express = require('express');
const { Pool } = require('pg');
const app = express();
app.use(express.json());

// Connect to the local Postgres container
const pool = new Pool({
  connectionString: process.env.DATABASE_URL,
});

// Basic health check endpoint
app.get('/api/health', async (req, res) => {
  try {
    await pool.query('SELECT 1');
    res.json({ status: 'OK', database: 'Connected' });
  } catch (error) {
    res.status(500).json({ status: 'Error', database: 'Disconnected', error: error.message });
  }
});

// Add your other API endpoints here
// app.post('/api/data', ...);
// app.get('/api/ai/chat', ...); // This would proxy to Ollama

app.listen(3000, '0.0.0.0', () => {
  console.log('API server listening on port 3000');
});
```

### **Element 5 ‚Äî Cloudflare Tunnel & Worker Routing**
Update your `config.yml` for `cloudflared` or via the Cloudflare Dashboard to route traffic:
```yaml
tunnel: pmerit-tunnel
credentials-file: /etc/cloudflared/credentials.json

ingress:
  # Route API requests
  - hostname: api.pmerit.com
    service: http://api:3000

  # Route AI requests
  - hostname: ai.pmerit.com
    service: http://ollama:11434

  # Route Syncthing UI
  - hostname: sync.pmerit.com
    service: http://syncthing:8384

  # Catch-all rule
  - service: http_status:404
```
The Cloudflare Worker can now simplify to proxying requests to these internal tunnel routes, or can be removed entirely if the tunnel routing is sufficient.

### **Element 6 ‚Äî Backups (Update for PostgreSQL)**
**`scripts/backup_database.sh` (NEW)**
```bash
#!/usr/bin/env bash
set -euo pipefail
ROOT="$(cd "$(dirname "$0")/.." && pwd)"
DATE=$(date +%Y%m%d-%H%M%S)
BACKUP_FILE="$ROOT/backups/postgres-backup-${DATE}.sql.gz"

echo "[*] Backing up PostgreSQL database..."
docker compose exec -T postgres pg_dump -U ${POSTGRES_USER} ${POSTGRES_DB} | gzip > "$BACKUP_FILE"

echo "[‚úì] Database backup complete: $BACKUP_FILE"
```

### **Element 7 ‚Äî Systemd Service**
The `systemd/pmerit-compose.service` file remains unchanged. It will now start the entire enhanced stack.

### **Element 8 ‚Äî Disaster Recovery Drill**
The process is now even more straightforward:
1.  Plug HDD into another machine.
2.  Install Docker.
3.  Run: `cd /pmerit/infra_portable && docker compose up -d`
4.  Everything starts: Database, API, AI, Sync.

### **Element 9 ‚Äî Encryption at Rest (Patch)**
This element remains critically important and unchanged. Encrypt the HDD (LUKS) and backup files (GPG) to protect your self-contained data.

### **Revised Ranking & Scaling Path**
*   **Current (HP + HDD + Docker + Postgres):** **Better ‚Üí Best.** The system is now fully self-contained and independent of any external cloud databases.
*   **With Dell Laptop Helper:** **Super.** Run an identical stack on the Dell for failover.
*   **With Dell Server as Primary:** **Super-Superior.** Move the portable drive to a more powerful machine for better performance.

### **Summary of Changes Made:**
*   **Removed Oracle:** All mentions of Oracle ADB, ORDS, OCI, and related backup scripts have been purged.
*   **Added PostgreSQL:** Integrated a local PostgreSQL container as the primary database.
*   **Added API Service:** Introduced a custom API service to replace ORDS functionality, providing a clean interface between your application and the database.
*   **Updated Diagrams & Descriptions:** All architecture diagrams and explanations now reflect the new, fully local stack.
*   **Updated Backups:** Replaced `backup_oracle.sh` with `backup_database.sh` for PostgreSQL.
*   **Enhanced Network:** Added a dedicated Docker network (`pmerit-net`) for secure container communication.
*   **Simplified Tunnel Routing:** The tunnel now routes directly to the API and Ollama containers, potentially simplifying or eliminating the need for complex Cloudflare Worker logic.

This plan represents a robust, secure, and truly portable infrastructure for the Pmerit platform.


*****# üéØ PMERIT Frontend Integration Patch - Ongoing Plan_vs2.txt

**Document Version:** 3.0 - Frontend Integration Edition  
**Status:** Implementation Blueprint  
**Base Infrastructure:** ‚úÖ Complete (78-table PostgreSQL, 16 elements)

---

## üìã Executive Summary

This patch document extends **Ongoing Plan_vs2.txt** with a comprehensive frontend implementation strategy that integrates with the completed 78-table PostgreSQL infrastructure. Following the successful element-by-element approach used for infrastructure, this plan implements a modular frontend system with full database integration, AI connectivity, and production deployment.

---

## üéØ Frontend Implementation Elements (F1-F12)

### **Element F1: Environment Access & Token Retrieval**
**Objective:** Gather all required credentials and configuration data from existing environments.

**Required Access:**
- **Cloudflare Dashboard:** Retrieve Pages deployment token, Workers API keys, Tunnel configurations
- **Database Credentials:** Extract PostgreSQL connection strings from infrastructure `.env`
- **AI Endpoint:** Verify `ai.pmerit.com` tunnel status and connectivity
- **BLS API:** Validate existing key `f3b54462bdd64a829a09dd23d1acb7cd`
- **GitHub Repository:** Confirm write access to existing repo structure

**Implementation Steps:**
1. Access Cloudflare Dashboard ‚Üí API Tokens ‚Üí Create custom token for Pages/Workers
2. Review `/pmerit/infra_portable/.env` for database credentials
3. Test AI endpoint: `curl https://ai.pmerit.com/api/tags`
4. Validate BLS API: `curl "https://api.bls.gov/publicAPI/v1/timeseries/data?registrationkey=f3b54462bdd64a829a09dd23d1acb7cd"`
5. Document all tokens in secure `.env.frontend` file

---

### **Element F2: Brand Identity & Design System Correction**
**Objective:** Implement proper PMERIT branding and white theme based on mobile reference design.

**Design Requirements:**
- **Base Document:** `!DOCTYPE html.txt` structure (preserve layout, correct colors)
- **Color Scheme:** Clean white theme (reference: OldMobile design.jpg)
- **Branding:** "PMERIT AI" (not Gabriel AI)
- **Layout:** Three-panel desktop, accordion mobile
- **Assessment:** Single "Discover Your Path (AI)" button

**CSS Design Tokens:**
```css
:root {
  --primary: #4F46E5;           /* PMERIT brand blue */
  --accent: #7C3AED;            /* Purple accent */
  --success: #10B981;           /* Green status */
  --bg-primary: #FFFFFF;        /* Clean white background */
  --bg-secondary: #F8FAFC;      /* Light gray panels */
  --text-primary: #1F2937;      /* Dark text */
  --card-bg: #FFFFFF;           /* Card backgrounds */
  --border: #E5E7EB;            /* Subtle borders */
}
```

---

### **Element F3: Template Scaffolding System**
**Objective:** Create DRY shared template system following Frontend Implementation Strategy.

**Phase A Implementation:**
```
/partials/
‚îú‚îÄ‚îÄ header.html          # Navigation + PMERIT branding
‚îú‚îÄ‚îÄ nav.html            # Role-based navigation logic  
‚îú‚îÄ‚îÄ footer.html         # Footer links + system status
‚îî‚îÄ‚îÄ modals.html         # Shared modal templates

/assets/
‚îú‚îÄ‚îÄ base.css            # Design system + grid layout
‚îú‚îÄ‚îÄ boot-includes.js    # Dynamic partial loader
‚îî‚îÄ‚îÄ nav-config.js       # Navigation access rules
```

**Template Structure:**
- **Header:** Logo, language selector, auth buttons
- **Navigation:** Context-aware menu (guest/student/admin)
- **Footer:** Status indicators, support links
- **Modals:** Authentication, assessment, career tracks

---

### **Element F4: Core Page Architecture**
**Objective:** Implement all user journey pages using shared template system.

**Phase B Implementation:**
```
Primary Pages (User Journey):
‚îú‚îÄ‚îÄ index.html          # Homepage (corrected design)
‚îú‚îÄ‚îÄ dashboard.html      # User dashboard
‚îú‚îÄ‚îÄ assessment.html     # Personality/skills assessment
‚îú‚îÄ‚îÄ courses.html        # Course catalog
‚îú‚îÄ‚îÄ classroom.html      # Learning environment
‚îú‚îÄ‚îÄ career.html         # Career paths + job data
‚îî‚îÄ‚îÄ library.html        # Resource library

Secondary Pages (Support):
‚îú‚îÄ‚îÄ support.html        # Help center
‚îú‚îÄ‚îÄ admin.html          # Administrative interface
‚îú‚îÄ‚îÄ pricing.html        # Subscription plans
‚îî‚îÄ‚îÄ about.html          # Platform information
```

**Page Template Pattern:**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{page_title}} - PMERIT</title>
    <link rel="stylesheet" href="/assets/base.css">
</head>
<body>
    <div id="header-container"></div>
    <div id="nav-container"></div>
    <main id="page-content">
        <!-- Page-specific content -->
    </main>
    <div id="footer-container"></div>
    <script src="/assets/boot-includes.js"></script>
    <script src="/assets/{{page_name}}.js"></script>
</body>
</html>
```

---

### **Element F5: Database Integration Layer**
**Objective:** Connect frontend to 78-table PostgreSQL infrastructure.

**Phase C Implementation:**

**API Endpoint Structure:**
```
/functions/api/
‚îú‚îÄ‚îÄ [[route]].js        # Cloudflare Workers main router
‚îú‚îÄ‚îÄ auth/               # Authentication endpoints
‚îú‚îÄ‚îÄ assessment/         # Personality/skills assessment
‚îú‚îÄ‚îÄ courses/           # Course management
‚îú‚îÄ‚îÄ career/            # Job market data (NBS/BLS)
‚îú‚îÄ‚îÄ ai/                # AI chat proxy
‚îî‚îÄ‚îÄ admin/             # Administrative functions
```

**Database Connection Pattern:**
```javascript
// Cloudflare Worker API Template
export default {
  async fetch(request, env) {
    const url = new URL(request.url);
    const path = url.pathname;
    
    // Database connection
    const db = new Database(env.DATABASE_URL);
    
    // Route handling
    switch (path) {
      case '/api/assessment/start':
        return handleAssessmentStart(request, db);
      case '/api/career/tracks':
        return handleCareerTracks(request, db);
      case '/api/ai/chat':
        return proxyToAI(request, env.AI_ENDPOINT);
    }
  }
};
```

**Key Integration Points:**
- **Assessment System:** `pmerit_personality_assessments`, `assessment_questions`, `assessment_responses`
- **Career Tracks:** `nigerian_job_market`, `us_job_market`, `cross_market_analysis`  
- **User Management:** `users`, `user_profiles`, `student_learning_profiles`
- **Course System:** `courses`, `enrollments`, `progress_tracking`

---

### **Element F6: AI Integration & Chat System**
**Objective:** Implement real-time AI chat connecting to existing ai.pmerit.com endpoint.

**Phase D Implementation:**

**AI Chat Architecture:**
```javascript
// /assets/ai-chat.js
class PMERITChat {
  constructor() {
    this.endpoint = 'https://ai.pmerit.com';
    this.models = ['phi3:mini', 'mistral'];
    this.mode = 'tutor'; // tutor, receptionist, support
  }
  
  async sendMessage(message, context = {}) {
    const response = await fetch(`${this.endpoint}/api/generate`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'phi3:mini',
        prompt: this.buildPrompt(message, context),
        stream: false
      })
    });
    return response.json();
  }
  
  buildPrompt(message, context) {
    const systemPrompt = this.getSystemPrompt();
    const userContext = this.formatContext(context);
    return `${systemPrompt}\n\nUser Context: ${userContext}\n\nUser: ${message}\nPMERIT AI:`;
  }
}
```

**AI Personas:**
- **Tutor Mode:** Educational guidance, course help
- **Receptionist Mode:** Platform navigation, general queries  
- **Support Mode:** Technical issues, account problems

---

### **Element F7: Assessment System Integration**
**Objective:** Implement comprehensive personality/skills assessment system.

**Assessment Flow:**
1. **Start Assessment:** Create session in `pmerit_personality_assessments`
2. **Question Delivery:** Fetch from `assessment_questions` table
3. **Response Capture:** Save to `assessment_responses` table  
4. **Analysis:** Generate results using AI + scoring algorithms
5. **Recommendations:** Create personalized learning plan

**Assessment Components:**
- **Personality Assessment:** Big Five (OCEAN) model
- **Learning Style:** Visual, Auditory, Kinesthetic preferences
- **Skills Gap Analysis:** Technical and soft skills evaluation
- **Interest Profiler:** Career preference mapping

**Cultural Adaptations:**
- **Nigerian Context:** Questions adapted for local culture
- **Language Support:** Yor√πb√°, Igbo, Hausa translations
- **Job Market Alignment:** Results tied to NBS data

---

### **Element F8: Career Tracks & Job Market Integration**
**Objective:** Connect career exploration to real-time NBS/BLS job market data.

**Career Track System:**
```javascript
// Career Tracks Integration
const careerTracks = [
  {
    id: 'grc_software',
    name: 'Global Remote Career - Software Development',
    market: 'US',
    source: 'BLS',
    skills: ['JavaScript', 'Python', 'React'],
    salary_range: '$50k-$120k',
    remote_friendly: true
  },
  {
    id: 'lcp_agriculture',
    name: 'Local Career - Agricultural Technology',
    market: 'Nigeria',
    source: 'NBS',
    skills: ['Farm Management', 'Irrigation', 'Crop Science'],
    salary_range: '‚Ç¶2M-‚Ç¶8M',
    local_demand: 'High'
  }
];
```

**Job Market Data Integration:**
- **NBS API:** Nigerian employment statistics
- **BLS API:** US labor market data (key: `f3b54462bdd64a829a09dd23d1acb7cd`)
- **Cross-Market Analysis:** Skills transferability, salary comparison
- **Real-Time Updates:** Daily job market data refresh

---

### **Element F9: Authentication & User Management**
**Objective:** Implement secure user authentication with role-based access.

**User Roles:**
- **Guest:** Assessment access, course browsing
- **Student:** Full course access, progress tracking
- **Instructor:** Course creation, student management
- **Admin Tier 1:** Global settings, user management
- **Admin Tier 2:** Content moderation, support

**Authentication Flow:**
```javascript
// Authentication System
class PMERITAuth {
  async signUp(userData) {
    // Create user in database
    const user = await db.users.create(userData);
    
    // Send verification email
    await this.sendVerification(user.email);
    
    // Create initial profile
    await db.user_profiles.create({
      user_id: user.id,
      onboarding_complete: false
    });
    
    return user;
  }
  
  async signIn(email, password) {
    // Verify credentials
    const user = await db.users.authenticate(email, password);
    
    // Generate session token
    const token = await this.generateToken(user.id);
    
    // Update last login
    await db.users.updateLastLogin(user.id);
    
    return { user, token };
  }
}
```

---

### **Element F10: Mobile Responsiveness & PWA Features**
**Objective:** Ensure mobile-first design with offline capabilities.

**Responsive Design:**
- **Breakpoints:** Mobile (<768px), Tablet (768-1024px), Desktop (>1024px)
- **Touch Targets:** Minimum 44px for accessibility
- **Accordion Panels:** Sidebar collapse on mobile
- **Gesture Support:** Swipe navigation, pull-to-refresh

**PWA Implementation:**
```javascript
// Service Worker for Offline Support
self.addEventListener('fetch', (event) => {
  // Cache strategy for educational content
  if (event.request.url.includes('/api/courses/')) {
    event.respondWith(
      caches.open('pmerit-courses').then(cache => {
        return cache.match(event.request).then(response => {
          return response || fetch(event.request).then(fetchResponse => {
            cache.put(event.request, fetchResponse.clone());
            return fetchResponse;
          });
        });
      })
    );
  }
});
```

---

### **Element F11: Deployment & CI/CD Pipeline**
**Objective:** Automate deployment to Cloudflare Pages with continuous integration.

**GitHub Actions Workflow:**
```yaml
# .github/workflows/deploy.yml
name: Deploy PMERIT Frontend
on:
  push:
    branches: [main]
    
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
          
      - name: Install dependencies
        run: npm install
        
      - name: Build project
        run: npm run build
        
      - name: Deploy to Cloudflare Pages
        uses: cloudflare/pages-action@v1
        with:
          apiToken: ${{ secrets.CLOUDFLARE_API_TOKEN }}
          accountId: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
          projectName: pmerit-platform
          directory: dist
          
      - name: Deploy Workers API
        run: npx wrangler publish
        env:
          CLOUDFLARE_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}
```

**Environment Variables:**
```env
# Cloudflare Pages Environment
CLOUDFLARE_API_TOKEN=your_api_token_here
CLOUDFLARE_ACCOUNT_ID=your_account_id_here
DATABASE_URL=postgresql://user:pass@host:5432/pmerit
AI_ENDPOINT=https://ai.pmerit.com
BLS_API_KEY=f3b54462bdd64a829a09dd23d1acb7cd
NBS_API_ENDPOINT=https://nigerianstat.gov.ng/api
```

---

### **Element F12: Testing & Performance Optimization**
**Objective:** Ensure production-ready performance with comprehensive testing.

**Testing Strategy:**
- **Unit Tests:** Individual component functionality
- **Integration Tests:** Database + API integration
- **E2E Tests:** Complete user journey testing
- **Performance Tests:** Page load times, AI response times
- **Accessibility Tests:** WCAG compliance, screen reader support

**Performance Targets:**
- **Page Load:** <2 seconds first contentful paint
- **AI Response:** <3 seconds for chat responses
- **Assessment:** <5 seconds question loading
- **Mobile Score:** >90 on Lighthouse mobile audit

---

## üöÄ Implementation Timeline

### **Phase 1: Foundation (Week 1)**
- F1: Environment Access & Token Retrieval
- F2: Brand Identity & Design System
- F3: Template Scaffolding System

### **Phase 2: Core Pages (Week 2)** 
- F4: Core Page Architecture
- F10: Mobile Responsiveness

### **Phase 3: Integration (Week 3)**
- F5: Database Integration Layer
- F6: AI Integration & Chat System
- F9: Authentication & User Management

### **Phase 4: Advanced Features (Week 4)**
- F7: Assessment System Integration
- F8: Career Tracks & Job Market Integration

### **Phase 5: Production (Week 5)**
- F11: Deployment & CI/CD Pipeline
- F12: Testing & Performance Optimization

---

## üîß Critical Dependencies

### **Infrastructure Requirements:**
- ‚úÖ PostgreSQL Database (78 tables deployed)
- ‚úÖ AI Endpoint (ai.pmerit.com operational)  
- ‚úÖ Cloudflare Tunnel (routing configured)
- ‚úÖ BLS API Access (key validated)

### **External Services:**
- **Cloudflare Pages:** Frontend hosting
- **Cloudflare Workers:** API layer
- **GitHub Actions:** CI/CD pipeline
- **Nigerian Bureau of Statistics:** Job market data

### **Development Tools:**
- **VS Code + GitHub Copilot:** Enhanced development
- **PostgreSQL Client:** Database management
- **Cloudflare CLI (Wrangler):** Deployment tools

---

## üìä Success Metrics

### **Technical Metrics:**
- **Uptime:** >99.9% availability
- **Performance:** <2s page loads, <3s AI responses
- **Database:** <100ms query response times
- **Mobile:** >90 Lighthouse score

### **User Experience Metrics:**
- **Assessment Completion:** >80% completion rate
- **User Retention:** >70% return within 7 days
- **Course Enrollment:** >60% post-assessment enrollment
- **Career Track Engagement:** >50% explore career paths

### **Business Metrics:**
- **User Registration:** Track guest ‚Üí student conversion
- **Course Completion:** Monitor learning outcomes
- **Job Market Alignment:** Measure career path relevance
- **Cultural Adaptation:** Nigerian user engagement rates

---

## ‚ö†Ô∏è Risk Mitigation

### **Technical Risks:**
- **Database Overload:** Implement connection pooling, query optimization
- **AI Endpoint Failure:** Add fallback responses, graceful degradation
- **Mobile Performance:** Optimize assets, implement lazy loading
- **Security Vulnerabilities:** Regular security audits, input validation

### **Integration Risks:**
- **API Rate Limits:** Implement caching, request batching
- **Third-party Dependencies:** Monitor service status, have fallbacks
- **Data Synchronization:** Implement eventual consistency patterns
- **Cross-browser Compatibility:** Comprehensive testing matrix

---

***Home Blueprint***
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PMERIT ‚Äî Accessible Global Education</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!--
    ==========================================================
      PMERIT Home Simulation - Footer Overlap Fix Applied
      - Fixed footer height calculations
      - Proper chat area spacing
      - Mobile layout improvements
    ==========================================================
  -->
  <style>
    :root{
      --global:#2563EB;
      --local:#16A34A;
      --accent:#7C3AED;
      --bg:#fff;
      --bg2:#f8fafc;
      --card:#fff;
      --ink:#1e293b;
      --muted:#64748b;
      --border:#e2e8f0;
      --shadow:0 4px 6px -1px rgba(0,0,0,.08),0 2px 4px -1px rgba(0,0,0,.06);
      --trans:all .23s cubic-bezier(.4,0,.2,1);
      --header-h: 70px;
      --footer-h: 50px;
    }
    .dark{ --bg:#0f172a; --bg2:#1e293b; --card:#1f2937; --ink:#e5e7eb; --muted:#94a3b8; --border:#334155; --shadow:0 4px 14px rgba(0,0,0,.39);}
    html,body{height:100vh;margin:0;padding:0;}
    body{
      background:var(--bg); color:var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, Noto Sans;
      transition:var(--trans); overflow:hidden; display:flex; flex-direction:column;
    }
    /* HEADER */
    header{
      flex:0 0 auto;
      height:var(--header-h);
      display:flex;align-items:center;justify-content:space-between; 
      gap:.75rem;padding:.75rem 1rem;
      background:var(--bg2); 
      box-shadow:var(--shadow);
      z-index:1000;
    }
    .logo{font-weight:800;font-size:1.25rem;color:var(--global);margin-right:auto;letter-spacing:.01em;}
    .logo span{color:var(--local);}
    nav{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap;}
    select,.btn{border:1px solid var(--border);background:transparent;color:var(--ink);padding:.5rem .75rem;border-radius:.5rem;font-weight:600;cursor:pointer;transition:var(--trans);min-height:44px;}
    .btn:hover{border-color:var(--global);color:var(--global);}
    .btn.primary{background:var(--global);color:#fff;border-color:var(--global);}
    .btn.primary:hover{filter:brightness(.96);}
    .link{background:none;border:none;color:var(--ink);cursor:pointer;font-weight:600;min-height:44px;} 
    .link:hover{color:var(--global);}
    
    /* LAYOUT - Fixed height calculations */
    .estate{
      flex:1 1 auto;
      display:grid;
      grid-template-columns:280px minmax(560px,1fr) 340px;
      gap:0;
      height:calc(100vh - var(--header-h) - var(--footer-h));
      max-height:calc(100vh - var(--header-h) - var(--footer-h));
      overflow:hidden;
    }
    aside.left, main.center, aside.right{
      height:100%;
      background:var(--bg);
      overflow-y:auto;
    }
    
    /* SIDEBAR */
    #page1{
      background:var(--bg2);
      border-right:1px solid var(--border);
      padding:1rem;
      display:flex;
      flex-direction:column;
      gap:.85rem;
      height:100%;
      overflow-y:auto;
    }
    .pane-title{font-weight:800;color:var(--global);margin:.25rem 0;}
    .action,.toggle{display:flex;align-items:center;justify-content:space-between;gap:.75rem;padding:.6rem .75rem;border:1px solid var(--border);border-radius:.65rem;background:transparent;color:var(--ink);cursor:pointer;transition:var(--trans);min-height:44px;text-align:left;}
    .action:hover,.toggle:hover{border-color:var(--global);}
    .icon{color:var(--global);margin-right:.5rem;}
    .toggle span{flex-grow:1;}
    .collapsible{border:1px solid var(--border);border-radius:.75rem;background:var(--card);overflow:hidden;display:flex;flex-direction:column;}
    .collapsible > .head{display:flex;align-items:center;justify-content:space-between;gap:.5rem;padding:.65rem .75rem;cursor:pointer;background:var(--bg);}
    .collapsible > .head h4{margin:0;font-size:.97rem;color:var(--global);}
    .collapsible .body{padding:.6rem;display:grid;gap:.5rem;}
    .switch{width:42px;height:22px;background:#cbd5e1;border-radius:999px;position:relative;flex:0 0 auto;}
    .switch::after{content:"";position:absolute;left:2px;top:2px;width:18px;height:18px;background:#fff;border-radius:999px;transition:var(--trans);}
    .toggle.active .switch{background:var(--global);}
    .toggle.active .switch::after{left:22px;}
    .dashboard{margin-top:.25rem;display:flex;gap:.5rem;align-items:center;justify-content:center;padding:.75rem .9rem;border:none;border-radius:.75rem;background:var(--global);color:#fff;font-weight:800;box-shadow:var(--shadow);min-height:44px;}
    .dashboard.guest{background:#64748b;}
    .avatar{width:100px;height:100px;border-radius:999px;margin-top:auto;background:linear-gradient(135deg, var(--global), var(--local));display:grid;place-items:center;color:#fff;font-size:2rem;border:3px solid var(--border);display:none;}
    .avatar.active{display:grid;}
    
    /* PMERIT AI BRAND BLOCK */
    .ai-brand-block {margin: 1.2rem 0 0.2rem 0; text-align: left;}
    .ai-title {font-weight: 700; color: var(--global); font-size: 1.1rem; margin-bottom: 0.22em;}
    .ai-tagline {font-size: 0.92rem; color: var(--muted);}
    
    /* MAIN CENTER (CHAT) - Fixed spacing */
    #page2{
      padding:1rem;
      display:flex;
      flex-direction:column;
      gap:.75rem;
      height:100%;
      overflow:hidden;
    }
    .panel{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:1rem;
      box-shadow:var(--shadow);
      height:100%;
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }
    .panel-head{
      background:var(--bg2);
      border-bottom:1px solid var(--border);
      padding:1rem;
      display:flex;
      gap:12px;
      align-items:center;
      flex:0 0 auto;
    }
    .badges{display:flex;gap:.4rem;flex-wrap:wrap;}
    .badge{background:var(--global);color:#fff;font-size:.75rem;padding:.25rem .6rem;border-radius:999px;display:inline-flex;align-items:center;gap:.3rem;}
    .badge.support{background:var(--local);}
    
    /* CHAT AREA - Fixed layout */
    #textChat{
      display:flex;
      flex-direction:column;
      height:100%;
      flex:1 1 auto;
    }
    .chat-body{
      flex:1 1 auto;
      overflow-y:auto;
      padding:1rem;
      display:flex;
      flex-direction:column;
      gap:.9rem;
    }
    .bubble{display:flex;gap:.65rem;align-items:flex-start;background:rgba(37,99,235,.06);border:1px solid rgba(37,99,235,.18);border-radius:.75rem;padding:1rem;}
    .ava{min-width:36px;height:36px;border-radius:999px;display:grid;place-items:center;color:#fff;background:linear-gradient(135deg, var(--global), var(--local));}
    .bubble h3{margin:.1rem 0 .35rem;color:var(--global);font-size:1rem;}
    .bubble p{margin:.3rem 0;line-height:1.55;}
    .bubble ul, .bubble ol{margin:.5rem 0 .5rem 1.25rem;}
    
    /* CHAT INPUT - Fixed positioning */
    .chat-input{
      flex:0 0 auto;
      border-top:1px solid var(--border);
      padding:.75rem;
      background:var(--bg2);
    }
    textarea{width:100%;min-height:80px;resize:none;background:var(--bg);color:var(--ink);border:1px solid var(--border);border-radius:.65rem;padding:.7rem;box-sizing:border-box;}
    textarea:focus{outline:none;box-shadow:0 0 0 3px rgba(37,99,235,.18);border-color:var(--global);}
    .input-bar{display:flex;align-items:center;justify-content:space-between;margin-top:.45rem;gap:.5rem;}
    .count{font-size:.9rem;color:var(--muted);}
    .send{border:none;background:var(--global);color:#fff;padding:.55rem 1rem;border-radius:.5rem;font-weight:700;cursor:pointer;flex:0 0 auto;}
    .input-options{display:flex;align-items:center;gap:.5rem;flex-wrap:wrap;}
    .input-options .btn-ghost{font-size:.93em;}
    
    /* Virtual Human Stage */
    #vhStage{display:none;flex-direction:column;height:100%;}
    .stage{flex:1 1 auto;display:grid;place-items:center;background:var(--bg);padding:1rem;overflow:hidden;}
    .human-frame{width:min(680px,90%);height:min(420px,55vh);border:2px solid var(--global);border-radius:1rem;box-shadow:var(--shadow);display:grid;place-items:center;background:linear-gradient(135deg,#e2e8f0,#f8fafc);position:relative;}
    .human-face{width:120px;height:120px;border-radius:999px;background:linear-gradient(135deg,var(--global),var(--local));display:grid;place-items:center;color:#fff;font-size:3rem;border:4px solid #fff;box-shadow:var(--shadow);}
    .captions{border-top:1px solid var(--border);background:var(--bg2);padding:.75rem 1rem;color:var(--muted);font-size:.95rem;}
    
    /* RIGHT PANE */
    #page3{
      background:var(--bg2);
      border-left:1px solid var(--border);
      padding:1rem;
      height:100%;
      overflow-y:auto;
    }
    .support-assistant{background:var(--card);border:1px solid var(--border);border-radius:1rem;padding:1rem;margin-bottom:1rem;display:flex;flex-direction:column;align-items:center;text-align:center;}
    .support-assistant h4{color:var(--local);margin:0;}
    #page3 h3{margin:.25rem 0 .75rem;position:relative;padding-bottom:.35rem;}
    #page3 h3::after{content:"";position:absolute;left:0;bottom:0;width:48px;height:3px;background:var(--global);border-radius:2px;}
    .cards{display:grid;gap:.6rem;grid-auto-rows:1fr;}
    .card{background:var(--card);border:1px solid var(--border);border-left:4px solid var(--global);border-radius:.75rem;padding:.9rem;box-shadow:var(--shadow);display:flex;flex-direction:column;justify-content:space-between;min-height:120px;}
    .card:nth-of-type(2){border-left-color:var(--local);}
    .card:nth-of-type(3){border-left-color:var(--accent);}
    .card h4{margin:.1rem 0 .35rem;display:flex;gap:.5rem;align-items:center;font-size:1rem;}
    .card p{margin:0 0 .6rem;color:var(--muted);font-size:.92rem;line-height:1.35;}
    .cta{width:100%;border:none;border-radius:.5rem;padding:.5rem .8rem;background:var(--global);color:#fff;font-weight:700;min-height:44px;}
    
    /* FOOTER - Fixed positioning and spacing */
    footer{
      position:fixed;
      bottom:0;
      left:0;
      width:100%;
      height:var(--footer-h);
      z-index:1000;
      border-top:1px solid var(--border);
      background:var(--bg2);
      padding:.5rem .75rem;
      font-size:.9rem;
      display:flex;
      align-items:center;
      gap:1rem;
      justify-content:center;
      flex-wrap:wrap;
      box-sizing:border-box;
    }
    .footer-status {
      display: inline-block;
      font-size: 0.93em;
      color: var(--global);
      margin-right: 2em;
      font-weight: 600;
      letter-spacing: 0.02em;
    }
    footer a{color:var(--muted);text-decoration:none;}
    footer a:hover{color:var(--global);}
    .btn-ghost{border:1px solid var(--border);border-radius:.5rem;padding:.25rem .6rem;background:transparent;cursor:pointer;}
    
    /* MOBILE/RESPONSIVE - Improved mobile layout */
    @media (max-width:1100px){
      :root{
        --header-h: 80px;
        --footer-h: 60px;
      }
      .estate{
        grid-template-columns:1fr;
        grid-template-rows:auto;
        height:calc(100vh - var(--header-h) - var(--footer-h));
        overflow-y:auto;
      }
      body{overflow-y:auto;overflow-x:hidden;}
      header{flex-wrap:wrap;gap:.75rem;height:var(--header-h);}
      .logo{margin-right:0;width:100%;text-align:center;order:0;}
      nav{width:100%;justify-content:center;order:1;gap:0.25rem;}
      aside.left{order:1;display:none;} 
      main.center{order:2;height:auto;min-height:calc(100vh - var(--header-h) - var(--footer-h) - 2rem);} 
      aside.right{order:3;display:none;}
      
      /* Mobile footer navigation */
      .mobile-footer{
        position:fixed;
        bottom:var(--footer-h);
        left:0;
        width:100%;
        background:var(--bg);
        border-top:1px solid var(--border);
        padding:.5rem;
        display:flex;
        justify-content:space-around;
        z-index:999;
        height:50px;
        box-sizing:border-box;
      }
      .mobile-footer button{
        flex:1;
        border:none;
        background:transparent;
        font-size:12px;
        color:var(--muted);
        min-height:40px;
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
        gap:.25rem;
      }
      .mobile-footer button:hover{color:var(--global);}
      .mobile-footer button i{font-size:1.2em;}
      
      /* Adjust content padding for mobile footer */
      #page2{
        padding-bottom:60px;
      }
    }
    
    @media (min-width:1101px){
      .mobile-footer{display:none;}
      aside.right{display:block;}
    }
    
    /* Focus states */
    .btn:focus,.action:focus,.toggle:focus,.dashboard:focus,.cta:focus,textarea:focus,select:focus,.btn-ghost:focus{outline:2px dashed var(--global);outline-offset:2px;}
    .no-scroll{overflow:hidden !important;}
    .non-scrollable-content{overflow-y:auto;}
    .hidden{display:none;}
    .visible{display:block;}
    
    /* DARK MODE OVERRIDES */
    .dark{background:#0f172a;--bg:#0f172a;--bg2:#1f2937;--card:#1e293b;--ink:#f8fafc;--muted:#94a3b8;--border:#334155;--shadow:0 4px 14px rgba(0,0,0,.39);}
    .dark header,.dark #page1,.dark footer{background:var(--bg2);}
    .dark .panel,.dark .collapsible,.dark .cards .card,.dark #page3 .support-assistant{background:var(--card);}
    .dark .panel-head,.dark .chat-input{background:var(--bg2);}
    .dark .bubble{background:rgba(37,99,235,.15);border-color:rgba(37,99,235,.3);}
    .dark .bubble p,.dark .bubble h3,.dark .badge,.dark .ai-title,.dark .ai-tagline,.dark .cta,.dark .dashboard,.dark .action,.dark .toggle,.dark .pane-title,.dark .collapsible .head h4,.dark .cards h4,.dark .cards p,.dark .footer a{color:var(--ink);}
    .dark .badge{color:var(--ink)!important;}
    .dark a{color:var(--muted);}
    .dark a:hover{color:var(--global);}
    .dark .switch::after{background:var(--bg);}
    .dark .toggle.active .switch::after{background:var(--ink);}
    .dark .dashboard{color:#fff;}
    .dark .support-assistant{color:var(--ink);}
  </style>
</head>
<body class="no-scroll">
  <!-- HEADER -->
  <header>
    <div class="logo">P<span>MERIT</span></div>
    <nav>
      <button class="link" id="donateLink">Donate</button>
      <select id="lang">
        <option value="en">English</option>
        <option value="yo">Yor√πb√°</option>
        <option value="ig">Igbo</option>
        <option value="ha">Hausa</option>
      </select>
      <button class="btn" id="signInBtn">Sign In</button>
      <button class="btn primary" id="startBtn">Start Learning</button>
    </nav>
  </header>
  <div class="estate">
    <!-- SIDEBAR (LEFT) -->
    <aside class="left">
      <section id="page1">
        <div>
          <div class="pane-title">Quick Actions</div>
          <button class="toggle" id="vhToggle">
            <span><i class="fas fa-user icon"></i> Virtual Human Mode</span>
            <span class="switch"></span>
          </button>
          <button class="action" id="careerPaths">
            <span><i class="fas fa-compass icon"></i> Career Track & Explore Paths</span>
            <i class="fas fa-chevron-right" aria-hidden="true"></i>
          </button>
          <button class="toggle" id="supportToggle">
            <span><i class="fas fa-headset icon"></i> Customer Service Mode</span>
            <span class="switch"></span>
          </button>
        </div>
        <div class="collapsible" id="settingsBox">
          <div class="head">
            <h4><i class="fas fa-sliders-h"></i> Settings</h4>
            <i class="fas fa-chevron-down" aria-hidden="true"></i>
          </div>
          <div class="body" style="display: none;">
            <button class="toggle" id="darkToggle">
              <span><i class="fas fa-moon icon"></i> Dark Mode</span>
              <span class="switch"></span>
            </button>
            <button class="toggle" id="ttsToggle">
              <span><i class="fas fa-volume-up icon"></i> Text-to-Speech</span>
              <span class="switch"></span>
            </button>
            <button class="action" id="voicesBtn">
              <span><i class="fas fa-headphones icon"></i> Preview Voices</span>
              <i class="fas fa-chevron-right" aria-hidden="true"></i>
            </button>
          </div>
        </div>
        <button class="dashboard guest" id="dashBtn"><i class="fas fa-gauge-high"></i>&nbsp;Dashboard</button>
        <div class="avatar" id="vhAvatar" title="Virtual Human">
          <i class="fas fa-user-circle"></i>
        </div>
        <!-- PMERIT AI Branding/Tagline Block -->
        <div class="ai-brand-block" id="sideBrandBlock">
          <div class="ai-title"><i class="fas fa-robot"></i> PMERIT AI</div>
          <div class="ai-tagline">Empowering Learning Through Innovation<br/>Accessible, high-quality education for global opportunities</div>
        </div>
      </section>
    </aside>
    <!-- MAIN CENTER (CHAT) -->
    <main class="center">
      <section id="page2" class="panel">
        <div class="panel-head">
          <!-- Only badges, NO big title/tagline here! -->
          <div class="badges">
            <span class="badge" id="vhBadge" style="display:none"><i class="fas fa-user-astronaut"></i> Virtual Human</span>
            <span class="badge support" id="supportBadge" style="display:none"><i class="fas fa-headset"></i> Support Assistant</span>
          </div>
        </div>
        <div id="textChat">
          <div class="chat-body non-scrollable-content" id="chatBody">
            <article class="bubble" id="welcomeMessageContainer">
              <div class="ava"><i class="fas fa-user-circle"></i></div>
              <div>
                <h3>PMERIT AI:</h3>
                <p id="welcomeMessage">Welcome to PMERIT! I'm here to guide your learning journey. Our mission is to provide accessible, high-quality education that opens doors to endless opportunities. How can I help you discover your potential today?</p>
              </div>
            </article>
          </div>
          <div class="chat-input">
            <textarea id="chatInput" maxlength="1000" placeholder="Ask about courses, learning paths, or your goals..."></textarea>
            <div class="input-bar">
              <span class="count" id="count">0/1000</span>
              <div class="input-options">
                <button class="btn-ghost"><i class="fas fa-user-astronaut"></i> VH Mode</button>
                <button class="btn-ghost"><i class="fas fa-book"></i> Read</button>
                <button class="btn-ghost"><i class="fas fa-network-wired"></i> Connected</button>
              </div>
              <button class="send" id="sendBtn" aria-label="Send"><span>Send</span> <i class="fas fa-paper-plane"></i></button>
            </div>
          </div>
        </div>
        <div id="vhStage" class="hidden">
          <div class="stage">
            <div class="human-frame">
              <div class="human-face"><i class="fas fa-user-circle"></i></div>
            </div>
          </div>
          <div class="captions" id="captions">Virtual Human is speaking‚Ä¶</div>
        </div>
      </section>
    </main>
    <!-- RIGHT PANE -->
    <aside class="right" id="rightPane">
      <section id="page3">
        <div class="support-assistant" id="supportAssistantPane">
          <h4><i class="fas fa-headset"></i> Support Assistant</h4>
          <p class="panel-header-tagline">Ask me About Pmerit</p>
          <div style="display:flex;gap:0.5rem;margin-top:0.5rem;">
            <button class="btn-ghost" style="border-color:var(--accent);color:var(--accent);"><i class="fas fa-user-astronaut"></i> Virtual Human</button>
            <button class="btn-ghost" style="border-color:var(--local);color:var(--local);"><i class="fas fa-headset"></i> Support Relates</button>
          </div>
        </div>
        <h3>Discover Your Path</h3>
        <div class="cards">
          <div class="card">
            <h4><i class="fas fa-graduation-cap"></i> Learning Style Assessment</h4>
            <p>Find how you learn best and personalize your experience to maximize outcomes.</p>
            <button class="cta" data-link="#todo-assessment">Start Assessment</button>
          </div>
          <div class="card">
            <h4><i class="fas fa-heart"></i> Interest Profiler</h4>
            <p>Explore subjects and fields that match your natural interests.</p>
            <button class="cta" data-link="#todo-interest">Discover Interests</button>
          </div>
          <div class="card">
            <h4><i class="fas fa-chart-line"></i> Skills Assessment</h4>
            <p>Assess your current abilities and identify growth opportunities.</p>
            <button class="cta" data-link="#todo-skills">Evaluate Skills</button>
          </div>
        </div>
      </section>
    </aside>
  </div>
  <!-- FOOTER -->
  <footer>
    <span class="footer-status" id="footerStatus">Connected to Educational Services</span>
    <a href="#privacy">Privacy & Terms</a>
    <a href="#contact">Contact</a>
    <a href="#partners">Partnerships</a>
    <a href="#support">Support</a>
  </footer>
  <!-- MOBILE FOOTER -->
  <div class="mobile-footer" id="mobileFooter">
    <button id="toggleLeft"><i class="fas fa-bars"></i><span>Menu</span></button>
    <button id="toggleRight"><i class="fas fa-chart-bar"></i><span>Tools</span></button>
  </div>
  <!-- PAGE 4‚Äì48 Placeholders for modular simulation -->
  <section id="page4" style="display:none"></section>
  <section id="page5" style="display:none"></section>
  <section id="page6" style="display:none"></section>
  <section id="page7" style="display:none"></section>
  <section id="page8" style="display:none"></section>
  <section id="page9" style="display:none"></section>
  <section id="page10" style="display:none"></section>
  <section id="page11" style="display:none"></section>
  <section id="page12" style="display:none"></section>
  <section id="page13" style="display:none"></section>
  <section id="page14" style="display:none"></section>
  <section id="page15" style="display:none"></section>
  <section id="page16" style="display:none"></section>
  <section id="page17" style="display:none"></section>
  <section id="page18" style="display:none"></section>
  <section id="page19" style="display:none"></section>
  <section id="page20" style="display:none"></section>
  <section id="page21" style="display:none"></section>
  <section id="page22" style="display:none"></section>
  <section id="page23" style="display:none"></section>
  <section id="page24" style="display:none"></section>
  <section id="page25" style="display:none"></section>
  <section id="page26" style="display:none"></section>
  <section id="page27" style="display:none"></section>
  <section id="page28" style="display:none"></section>
  <section id="page29" style="display:none"></section>
  <section id="page30" style="display:none"></section>
  <section id="page31" style="display:none"></section>
  <section id="page32" style="display:none"></section>
  <section id="page33" style="display:none"></section>
  <section id="page34" style="display:none"></section>
  <section id="page35" style="display:none"></section>
  <section id="page36" style="display:none"></section>
  <section id="page37" style="display:none"></section>
  <section id="page38" style="display:none"></section>
  <section id="page39" style="display:none"></section>
  <section id="page40" style="display:none"></section>
  <section id="page41" style="display:none"></section>
  <section id="page42" style="display:none"></section>
  <section id="page43" style="display:none"></section>
  <section id="page44" style="display:none"></section>
  <section id="page45" style="display:none"></section>
  <section id="page46" style="display:none"></section>
  <section id="page47" style="display:none"></section>
  <section id="page48" style="display:none"></section>
  <!-- MODALS (CareerTrack, Voices) -->
  <dialog id="tracksModal" style="border:none;border-radius:12px;max-width:560px;width:92%;box-shadow:var(--shadow);background:var(--card);color:var(--ink)">
    <form method="dialog" style="margin:0;padding:1rem 1rem 1.1rem;">
      <h3 style="margin:.25rem 0 1rem;color:var(--global);display:flex;gap:.5rem;align-items:center"><i class="fas fa-compass"></i> Explore Career Tracks</h3>
      <div id="tracksList" style="display:grid;gap:.5rem;"></div>
      <div style="display:flex;justify-content:flex-end;gap:.5rem;margin-top:1rem">
        <button class="btn" value="cancel">Close</button>
      </div>
    </form>
  </dialog>
  <dialog id="voicesModal" style="border:none;border-radius:12px;max-width:640px;width:92%;box-shadow:var(--shadow);background:var(--card);color:var(--ink)">
    <form method="dialog" style="margin:0;padding:1rem 1.1rem">
      <h3 style="margin:.25rem 0 1rem;color:var(--global);display:flex;gap:.5rem;align-items:center">
        <i class="fas fa-headphones"></i> Voice Sampler
      </h3>
      <label style="display:grid;gap:.35rem">
        <span style="font-weight:600">Sample text</span>
        <textarea id="voiceSampleText" rows="3" style="border:1px solid var(--border);border-radius:.65rem;padding:.6rem">
Welcome to PMERIT. Empowering learning through innovation.
        </textarea>
      </label>
      <div id="voiceTabs" style="display:flex;gap:.4rem;margin-bottom:.6rem;">
        <button type="button" class="btn active" data-tab="opensource">Open-source</button>
        <button type="button" class="btn" data-tab="premium">Premium</button>
      </div>
      <div id="voicePanels" style="display:grid;gap:.6rem;">
        <section data-panel="opensource">
          <div class="voice-row">
            <div class="voice-meta"><strong>Coqui XTTS</strong><br/><span class="muted">Multilingual, expressive</span></div>
            <audio controls preload="none" src="" data-src="https://huggingface.co/spaces/coqui/xtts/resolve/main/samples/en-US.wav"></audio>
          </div>
          <div class="voice-row">
            <div class="voice-meta"><strong>Piper TTS</strong><br/><span class="muted">Lightweight, fast (CPU)</span></div>
            <audio controls preload="none" src="" data-src="https://huggingface.co/datasets/coqui/vctk/resolve/main/audio/p225/p225_001.wav"></audio>
          </div>
          <div class="voice-row">
            <div class="voice-meta"><strong>MeloTTS</strong><br/><span class="muted">Multilingual, natural</span></div>
            <audio controls preload="none" src="" data-src="https://cdn.jsdelivr.net/gh/Myshell-AI/MeloTTS@main/melo_tts_example.wav"></audio>
          </div>
        </section>
        <section data-panel="premium" style="display:none">
          <div class="voice-row">
            <div class="voice-meta"><strong>ElevenLabs</strong><br/><span class="muted">AI Voice 1 (Male)</span></div>
            <audio controls preload="none" src="" data-src="https://cdn.elevenlabs.io/api/v1/voices/21m00wZ9gJ79fH0U8UqV/samples/u99U4H9oO2A.mp3"></audio>
          </div>
          <div class="voice-row">
            <div class="voice-meta"><strong>ElevenLabs</strong><br/><span class="muted">AI Voice 2 (Female)</span></div>
            <audio controls preload="none" src="" data-src="https://cdn.elevenlabs.io/api/v1/voices/21m00wZ9gJ79fH0U8UqV/samples/G13iGk9oR2A.mp3"></audio>
          </div>
        </section>
      </div>
      <div style="display:flex;justify-content:space-between;align-items:center;gap:.5rem;margin-top:1rem">
        <button class="btn" id="browserTtsBtn" type="button">Browser TTS (fallback)</button>
        <div style="display:flex;gap:.5rem">
          <button class="btn" value="cancel">Close</button>
        </div>
      </div>
      <audio id="voicePlayer" preload="auto"></audio>
    </form>
  </dialog>
  <!-- JS (scoped to modular pages, future extract) -->
  <script>
    const $ = (s,r=document)=>r.querySelector(s); const $$ = (s,r=document)=>Array.from(r.querySelectorAll(s));
    const body = document.body;
    const vhToggle = $('#vhToggle'), vhAvatar = $('#vhAvatar'), vhBadge = $('#vhBadge'), supportToggle = $('#supportToggle'), supportBadge = $('#supportBadge'), dashBtn = $('#dashBtn'), settingsBox = $('#settingsBox'), settingsHead = settingsBox.querySelector('.head'), settingsBody = settingsBox.querySelector('.body'), darkToggle = $('#darkToggle'), ttsToggle = $('#ttsToggle'), textChat = $('#textChat'), vhStage = $('#vhStage'), chatInput = $('#chatInput'), count = $('#count'), sendBtn = $('#sendBtn'), chatBody = $('#chatBody'), careerPathsBtn = $('#careerPaths'), tracksModal = $('#tracksModal'), tracksList = $('#tracksList'), leftPane = $('aside.left'), rightPane = $('aside.right'), toggleLeftBtn = $('#toggleLeft'), toggleRightBtn = $('#toggleRight'), signInBtn = $('#signInBtn'), welcomeMessageContainer = $('#welcomeMessageContainer'), voicesBtn  = $('#voicesBtn'), voicesDlg  = $('#voicesModal'), voiceTabs  = $('#voiceTabs'), voicePanels= $('#voicePanels'), browserTtsBtn = $('#browserTtsBtn'), voiceSampleText = $('#voiceSampleText'), supportAssistantPane = $('#supportAssistantPane'), mobileFooter = $('#mobileFooter');
    const state = {auth: false, dark: false, vhMode: false, supportMode: false, tts: false};
    const CAREER_TRACKS = [
      "Software Development (Full-stack)",
      "Data Analytics",
      "UI/UX Design",
      "Digital Marketing",
      "Customer Support (Remote)",
      "Virtual Assistance / Operations",
      "Cloud & DevOps (Intro)"
    ];
    function init() {
      try {state.dark = localStorage.getItem('pmerit_dark') === 'true';state.auth = localStorage.getItem('pmerit_auth') === 'true';state.tts = localStorage.getItem('pmerit_tts') === 'true';}catch{}
      body.classList.toggle('dark', state.dark);
      if(state.dark) darkToggle.classList.add('active');
      if(state.tts) ttsToggle.classList.add('active');
      dashBtn.classList.toggle('guest', !state.auth);
      rightPane.prepend(supportAssistantPane);
      tracksList.innerHTML = CAREER_TRACKS.map((t,i)=>`<button class="action" value="${i}" style="justify-content:flex-start"><i class="fas fa-arrow-right icon"></i><span>${t}</span></button>`).join('');
      if(window.innerWidth<=1100){leftPane.style.display='none';rightPane.style.display='none';mobileFooter.style.display='flex';}else{leftPane.style.display='flex';rightPane.style.display='block';mobileFooter.style.display='none';}
      updateChatView(); updateCount(); updateDashboardButton();
    }
    function save(k,v){try{localStorage.setItem(k,String(v));}catch{}}
    function updateCount(){count.textContent=(chatInput.value||'').length+'/1000';}
    function speak(text){if(!state.tts)return;if(!('speechSynthesis'in window)){return;}const u=new SpeechSynthesisUtterance(text);speechSynthesis.speak(u);}
    function updateDashboardButton(){if(state.auth){dashBtn.innerHTML='<i class="fas fa-gauge-high"></i>&nbsp;Dashboard';dashBtn.classList.remove('guest');}else{dashBtn.innerHTML='<i class="fas fa-gauge-high"></i>&nbsp;Dashboard';dashBtn.classList.add('guest');}}
    settingsHead.addEventListener('click',()=>{const open=settingsBody.style.display==='block';settingsBody.style.display=open?'none':'block';settingsHead.querySelector('i.fas').className=open?'fas fa-sliders-h':'fas fa-chevron-down';});
    darkToggle.addEventListener('click',()=>{darkToggle.classList.toggle('active');state.dark=darkToggle.classList.contains('active');body.classList.toggle('dark',state.dark);save('pmerit_dark',state.dark);});
    ttsToggle.addEventListener('click',()=>{ttsToggle.classList.toggle('active');state.tts=ttsToggle.classList.contains('active');save('pmerit_tts',state.tts);if(!state.tts)speechSynthesis.cancel();});
    supportToggle.addEventListener('click',()=>{supportToggle.classList.toggle('active');state.supportMode=supportToggle.classList.contains('active');supportBadge.style.display=state.supportMode?'inline-flex':'none';});
    vhToggle.addEventListener('click',()=>{vhToggle.classList.toggle('active');state.vhMode=vhToggle.classList.contains('active');updateChatView();});
    function updateChatView(){if(state.vhMode){textChat.style.display='none';vhStage.classList.add('visible');vhStage.classList.remove('hidden');vhAvatar.classList.add('active');vhBadge.style.display='inline-flex';}else{textChat.style.display='flex';vhStage.classList.remove('visible');vhStage.classList.add('hidden');vhAvatar.classList.remove('active');vhBadge.style.display='none';}}
    dashBtn.addEventListener('click',()=>{if(state.auth){window.location.href='dashboard.html';}else{alert('Please sign up to access your dashboard.');}});
    signInBtn.addEventListener('click',()=>{state.auth=!state.auth;save('pmerit_auth',state.auth);updateDashboardButton();alert(state.auth?'Signed in (demo). Dashboard enabled.':'Signed out (demo).');});
    $('#startBtn').addEventListener('click',()=>alert('Starting learning journey‚Ä¶'));
    chatInput.addEventListener('input',updateCount);
    sendBtn.addEventListener('click',()=>{
      const text=(chatInput.value||'').trim();if(!text)return;
      if(welcomeMessageContainer){welcomeMessageContainer.style.display='none';}
      const me=document.createElement('article');me.className='bubble';me.innerHTML='<div class="ava" style="background:#4f46e5"><i class="fas fa-user-circle"></i></div><div><h3>You</h3><p></p></div>';me.querySelector('p').textContent=text;chatBody.appendChild(me);chatBody.scrollTop=chatBody.scrollHeight;
      setTimeout(()=>{const aiResponse=state.supportMode?"Thank you for your inquiry. A support agent will get back to you shortly.":"Based on your goals, I recommend exploring our `UI/UX Design` career track. Would you like me to tell you more about it?";const ai=document.createElement('article');ai.className='bubble';ai.innerHTML='<div class="ava"><i class="fas fa-user-circle"></i></div><div><h3>PMERIT AI:</h3><p></p></div>';ai.querySelector('p').textContent=aiResponse;chatBody.appendChild(ai);chatBody.scrollTop=chatBody.scrollHeight;if(state.tts)speak(aiResponse);},600);
      chatInput.value='';updateCount();
    });
    careerPathsBtn.addEventListener('click',()=>{if(typeof tracksModal.showModal==='function'){tracksModal.showModal();}else{alert('Tracks:\n- '+CAREER_TRACKS.join('\n- '));}});
    tracksList.addEventListener('click',e=>{const btn=e.target.closest('button.action');if(!btn)return;const idx=Number(btn.value);alert('Selected: '+CAREER_TRACKS[idx]);});
    function setVoiceTab(name){$$('[data-tab]',voiceTabs).forEach(b=>{b.classList.toggle('active',b.dataset.tab===name);});$$('[data-panel]',voicePanels).forEach(p=>{const isActive=p.dataset.panel===name;p.style.display=isActive?'block':'none';if(isActive){p.querySelectorAll('audio[data-src]').forEach(a=>{if(!a.src||a.src.endsWith('#')){a.src=a.dataset.src||'#';}});}});}
    voicesBtn.addEventListener('click',()=>{if(typeof voicesDlg.showModal==='function'){voicesDlg.showModal();}else{alert('Voice Sampler requires a modern browser.');}setVoiceTab('opensource');});
    voiceTabs.addEventListener('click',(e)=>{const btn=e.target.closest('button.btn');if(!btn)return;setVoiceTab(btn.dataset.tab);});
    voicesDlg.addEventListener('play',(e)=>{if(e.target.tagName!=='AUDIO')return;voicesDlg.querySelectorAll('audio').forEach(a=>{if(a!==e.target)a.pause();});},true);
    browserTtsBtn.addEventListener('click',()=>{const text=(voiceSampleText?.value||'').trim();if(!text)return;if(!('speechSynthesis'in window)){alert('Browser TTS not supported here.');return;}voicesDlg.querySelectorAll('audio').forEach(a=>a.pause());const u=new SpeechSynthesisUtterance(text);u.rate=.95;u.pitch=1;u.volume=1;speechSynthesis.cancel();speechSynthesis.speak(u);});
    toggleLeftBtn.addEventListener('click',()=>{leftPane.style.display=(leftPane.style.display==='none'||leftPane.style.display==='')?'flex':'none';rightPane.style.display='none';});
    toggleRightBtn.addEventListener('click',()=>{rightPane.style.display=(rightPane.style.display==='none'||rightPane.style.display==='')?'block':'none';leftPane.style.display='none';});
    window.addEventListener('resize',()=>{if(window.innerWidth>1100){body.classList.add('no-scroll');leftPane.style.display='flex';rightPane.style.display='block';mobileFooter.style.display='none';}else{body.classList.remove('no-scroll');leftPane.style.display='none';rightPane.style.display='none';mobileFooter.style.display='flex';}});
    init();
  </script>
</body>
</html>
