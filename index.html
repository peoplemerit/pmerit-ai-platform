<!--
  PMERIT Modular Home Simulation: index-dev.html
  Element F1: Core HTML Structure Integration Plan
  - Modular simulation: each major page is a <section id="pageX"> with local <style> and <script>
  - Home Section: Step 1: Assessment Integration, Step 2: AI Chat, Step 3: Auth, Step 4: Cultural Context
  - All code is automation-ready for future extraction (pageX.html, pageX.css, pageX.js)
  - Follows PMERIT Web Page Development Protocol & Element F1 criteria
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>PMERIT ‚Äî Accessible Global Education</title>

  <!-- Icons & Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>

  <!-- Global root variables for color scheme, edge layout, minimal mobile scroll -->
  <style>
    :root {
      --primary: #2563EB;
      --primary-dark: #1D4ED8;
      --accent: #7E22CE;
      --success: #059669;
      --text-primary: #1F2937;
      --text-secondary: #6B7280;
      --text-inverse: #F9FAFB;
      --bg-primary: #FFFFFF;
      --bg-secondary: #F3F4F6;
      --bg-dark: #111827;
      --card-bg: #FFFFFF;
      --border-color: #E5E7EB;
      --header-height: 70px;
      --footer-height: 60px;
      --sidebar-width: 280px;
      --rightbar-width: 320px;
      --shadow: 0 4px 12px -1px rgba(0,0,0,0.09);
      --shadow-lg: 0 12px 24px -6px rgba(0,0,0,0.12);
      --transition: all 0.18s cubic-bezier(.4,0,.2,1);
    }
    body, html {
      height: 100%;
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      overflow: hidden;
    }
    .dark {
      --text-primary: #F9FAFB;
      --text-secondary: #D1D5DB;
      --bg-primary: #111827;
      --bg-secondary: #1F2937;
      --card-bg: #1F2937;
      --border-color: #374151;
    }
    * { box-sizing: border-box; }
  </style>
</head>
<body>
  <!-- ===================================== -->
  <!--          SECTION: PAGE 1 - HOME       -->
  <!-- ===================================== -->
  <section id="page1">
    <!-- ========== Top Edge: Header/Nav ========== -->
    <header id="mainHeader" aria-label="Sitewide Navigation">
      <div class="logo">PMERIT</div>
      <nav>
        <select class="nav-btn" id="lang" aria-label="Language">
          <option value="en">English</option>
          <option value="yo">Yor√πb√°</option>
          <option value="ig">Igbo</option>
          <option value="ha">Hausa</option>
        </select>
        <button class="nav-btn" id="donateBtn">Donate</button>
        <button class="nav-btn" id="signInBtn">Sign In</button>
        <button class="nav-btn primary" id="startBtn">Start Learning</button>
      </nav>
    </header>

    <!-- ========== 3-Pane Edge Layout ========== -->
    <div class="estate">
      <!-- ‚óÄÔ∏è Left Sidebar -->
      <aside id="left" aria-label="Quick actions sidebar">
        <section>
          <div class="pane-title">Quick Actions</div>
          <button class="toggle" id="vhToggle">
            <span><i class="fas fa-user-astronaut icon"></i> Virtual Human Mode</span>
            <span class="switch"></span>
          </button>
          <button class="action" id="careerPaths">
            <span><i class="fas fa-compass icon"></i> Career Track & Explore Paths</span>
            <i class="fas fa-chevron-right"></i>
          </button>
          <button class="toggle" id="supportToggle">
            <span><i class="fas fa-headset icon"></i> Customer Service Mode</span>
            <span class="switch"></span>
          </button>
          <div class="collapsible" id="settingsBox">
            <div class="head">
              <strong><i class="fas fa-sliders-h"></i> Settings</strong>
              <i class="fas fa-chevron-down"></i>
            </div>
            <div class="body">
              <button class="toggle" id="darkToggle">
                <span><i class="fas fa-moon icon"></i> Dark Mode</span>
                <span class="switch"></span>
              </button>
              <button class="toggle" id="ttsToggle">
                <span><i class="fas fa-volume-up icon"></i> Text-to-Speech</span>
                <span class="switch"></span>
              </button>
              <button class="action" id="voicesBtn">
                <span><i class="fas fa-headphones icon"></i> Preview Voices</span>
                <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
          <button class="dashboard guest" id="dashBtn">
            <i class="fas fa-gauge-high"></i> Dashboard
          </button>
          <div class="avatar" id="vhAvatar" title="Virtual Human" style="display:none;">
            <i class="fas fa-user-circle"></i>
          </div>
        </section>
      </aside>

      <!-- üè† Center: AI Chat Panel -->
      <main>
        <section class="panel" aria-label="Chat panel">
          <div class="panel-head">
            <span style="font-weight:600; color:var(--primary);">PMERIT AI</span>
            <span class="tagline" style="color: var(--text-secondary); font-size:0.95em; margin-left:.5em">Accessible Global Education. Ask me anything!</span>
            <div class="badges">
              <span class="badge vh" id="vhBadge" style="display:none">
                <i class="fas fa-user-astronaut"></i> Virtual Human
              </span>
              <span class="badge support" id="supportBadge" style="display:none">
                <i class="fas fa-headset"></i> Support Assistant
              </span>
            </div>
          </div>
          <div id="textChat" role="region" aria-live="polite">
            <div class="chat-body" id="chatMessages">
              <article class="bubble" id="welcomeMsg">
                <div class="ava"><i class="fas fa-user-circle"></i></div>
                <div>
                  <h3>PMERIT AI:</h3>
                  <p id="welcomeCopy">Welcome to PMERIT! I'm here to guide your learning journey. Our mission is to provide accessible, high-quality education that opens doors to endless opportunities. Ask about courses, learning paths, or your goals.</p>
                </div>
              </article>
            </div>
            <div class="chat-input">
              <textarea id="chatInput" maxlength="1000" placeholder="Ask about courses, learning paths, or your goals..." aria-label="Message"></textarea>
              <div class="input-bar">
                <span class="count" id="count">0/1000</span>
                <div class="input-actions">
                  <button class="nav-btn" id="vhQuick"><i class="fas fa-user-astronaut"></i> VH Mode</button>
                  <button class="nav-btn" id="readAbout"><i class="fas fa-book"></i> Read About</button>
                  <span class="footer-status">
                    <i class="fas fa-circle-check"></i> Connected to Educational Services
                  </span>
                </div>
                <button class="send" id="sendBtn">Send <i class="fas fa-paper-plane"></i></button>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- ‚ñ∂Ô∏è Right: Assessments & Assistant -->
      <aside id="right" aria-label="Assessment tools and support">
        <div class="support-assistant" id="supportAssistant">
          <h4><i class="fas fa-headset"></i> Support Assistant</h4>
          <p id="supportPrompt">Empowering Learning Through Innovation...</p>
        </div>
        <h3>Assessments</h3>
        <div class="discover">
          <h4>Learning Style</h4>
          <p>Find your optimal way to learn.</p>
          <button class="nav-btn primary" id="beginLearningStyle">Begin</button>
        </div>
        <div class="discover">
          <h4>Interest Profiler</h4>
          <p>Discover what excites you most!</p>
          <button class="nav-btn primary" id="beginInterestProfiler">Begin</button>
        </div>
        <div class="discover">
          <h4>Skills Assessment</h4>
          <p>Measure your current skills and strengths.</p>
          <button class="nav-btn primary" id="beginSkillsAssessment">Begin</button>
        </div>
      </aside>
    </div>

    <!-- ========== Bottom Edge: Footer ========== -->
    <footer>
      <div class="footer-status-main">
        <i class="fas fa-signal"></i> Connected to Educational Services
      </div>
      <div class="footer-links">
        <button class="nav-btn" id="toggleFont">A+</button>
        <button class="nav-btn" id="toggleContrast"><i class="fas fa-adjust"></i></button>
        <select class="nav-btn" id="footerLang" aria-label="Language">
          <option value="en">English</option>
          <option value="yo">Yor√πb√°</option>
          <option value="ig">Igbo</option>
          <option value="ha">Hausa</option>
        </select>
        <a href="#" class="nav-btn">Privacy</a>
        <a href="#" class="nav-btn">Terms</a>
        <a href="#" class="nav-btn">Contact</a>
        <a href="#" class="nav-btn">Partnerships</a>
        <a href="#" class="nav-btn">Support</a>
      </div>
    </footer>

    <!-- ========== Mobile Accordions (Collapsible Sidebars) ========== -->
    <div id="mobileAccordions" aria-label="Mobile sections">
      <details class="mobile-accordion">
        <summary><i class="fas fa-bolt"></i> Quick Actions - Tap to expand ‚ñº</summary>
        <div class="mobile-accordion-content">
          <div class="mobile-grid">
            <button class="mobile-card" id="m_vhToggle"><i class="fas fa-user-astronaut"></i> <span>Virtual Human</span><div class="switch"></div></button>
            <button class="mobile-card" id="m_careerPaths"><i class="fas fa-compass"></i> <span>Career Paths</span></button>
            <button class="mobile-card" id="m_supportToggle"><i class="fas fa-headset"></i> <span>Support Mode</span><div class="switch"></div></button>
            <button class="mobile-card" id="m_settings"><i class="fas fa-cog"></i> <span>Settings</span></button>
          </div>
          <button class="dashboard guest nav-btn" id="m_dashBtn" style="margin-top:1rem;width:100%">
            <i class="fas fa-gauge-high"></i> Dashboard
          </button>
        </div>
      </details>
      <details class="mobile-accordion">
        <summary><i class="fas fa-graduation-cap"></i> Discover Your Path - Tap to expand ‚ñº</summary>
        <div class="mobile-accordion-content">
          <div class="discover" style="margin:0">
            <h4>Personalized learning plan</h4>
            <p>Start a short flow that blends learning style, interests, and skills into a plan.</p>
            <button class="nav-btn primary" id="m_beginAssessment">Begin Assessment</button>
          </div>
        </div>
      </details>
    </div>
  </section>
  <!-- ================= END OF PAGE1 ================== -->

  <!-- ========== Scoped Styles for Page1 ========== -->
  <style>
    #page1 .estate {
      display: grid;
      grid-template-columns: var(--sidebar-width) 1fr var(--rightbar-width);
      height: calc(100vh - var(--header-height) - var(--footer-height));
      overflow: hidden;
      gap: 0;
    }
    @media (max-width: 1100px) {
      #page1 .estate { grid-template-columns: 1fr; }
      #page1 aside#left, #page1 aside#right { display: none; }
      #mobileAccordions { display: block; }
    }
    @media (min-width: 1101px) {
      #mobileAccordions { display:none; }
    }
    #page1 header, #page1 footer {
      position: relative;
      z-index: 10;
      background: var(--card-bg);
      border-bottom: 1px solid var(--border-color);
      border-top: 1px solid var(--border-color);
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 1.5rem;
      height: var(--header-height);
    }
    #page1 header { border-top: none; }
    #page1 footer {
      height: var(--footer-height);
      border-bottom: none;
      border-top: 1px solid var(--border-color);
      position: fixed;
      bottom: 0; left: 0; width: 100vw;
      background: var(--card-bg);
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      box-shadow: 0 -2px 8px rgba(0,0,0,0.07);
    }
    /* ... other styles omitted for brevity; use those from original index.html, scoped to #page1 ... */
  </style>

  <!-- ========== Scoped Scripts for Page1 ========== -->
  <script>
    // Scoped to #page1 only

    // ========== Step 1: Assessment Integration ==========
    async function fetchAssessmentQuestions() {
      // Simulate DB fetch; replace with real endpoint
      return fetch('/api/assessment_questions').then(r => r.json());
    }
    function startAssessment(questions) {
      alert('Assessment Started: ' + JSON.stringify(questions.slice(0,5)));
      // TODO: Render assessment modal
    }
    // Mobile button
    document.getElementById('m_beginAssessment')?.addEventListener('click', async () => {
      const questions = await fetchAssessmentQuestions();
      startAssessment(questions);
    });
    // Desktop buttons
    document.getElementById('beginLearningStyle')?.addEventListener('click', async () => {
      const questions = await fetchAssessmentQuestions();
      startAssessment(questions.filter(q => q.type === "learning_style"));
    });
    document.getElementById('beginInterestProfiler')?.addEventListener('click', async () => {
      const questions = await fetchAssessmentQuestions();
      startAssessment(questions.filter(q => q.type === "interest"));
    });
    document.getElementById('beginSkillsAssessment')?.addEventListener('click', async () => {
      const questions = await fetchAssessmentQuestions();
      startAssessment(questions.filter(q => q.type === "skills"));
    });

    // ========== Step 2: AI Chat Integration ==========
    async function sendAIMessage(message, context={}) {
      // TODO: add userId/context as needed
      const resp = await fetch('https://ai.pmerit.com/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message, ...context })
      });
      return resp.json();
    }
    document.getElementById('sendBtn')?.addEventListener('click', async () => {
      const chatInput = document.getElementById('chatInput');
      const msg = chatInput.value.trim();
      if (!msg) return;
      // Show user message
      const chatBody = document.getElementById('chatMessages');
      const userBubble = document.createElement('article');
      userBubble.className = 'bubble';
      userBubble.innerHTML = `<div class="ava" style="background:var(--primary)"><i class="fas fa-user"></i></div><div><h3>You:</h3><p>${msg}</p></div>`;
      chatBody.appendChild(userBubble);
      chatInput.value = '';
      document.getElementById('count').textContent = '0/1000';
      // Fetch AI response
      const resp = await sendAIMessage(msg, {/* userId/context here */});
      const aiBubble = document.createElement('article');
      aiBubble.className = 'bubble';
      aiBubble.innerHTML = `<div class="ava"><i class="fas fa-user-circle"></i></div><div><h3>PMERIT AI:</h3><p>${resp.reply || '[No response]'}</p></div>`;
      chatBody.appendChild(aiBubble);
      chatBody.scrollTop = chatBody.scrollHeight;
    });
    document.getElementById('chatInput')?.addEventListener('input', (e) => {
      document.getElementById('count').textContent = `${e.target.value.length}/1000`;
    });

    // ========== Step 3: User Authentication Integration ==========
    async function authenticateUser(email, password) {
      // Replace with real server call to users table
      return fetch('/api/auth/signin', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      }).then(r => r.json());
    }
    function updateUIForLoggedInUser(user) {
      // TODO: Replace Sign In/Start buttons, update dashboard, etc.
      document.getElementById('signInBtn').style.display = 'none';
      document.getElementById('startBtn').textContent = 'Dashboard';
      document.getElementById('dashBtn').classList.remove('guest');
      document.getElementById('dashBtn').textContent = user.name + "'s Dashboard";
      // Save session, update localStorage as needed
    }
    document.getElementById('signInBtn')?.addEventListener('click', () => {
      // Show modal (not shown here for brevity)
      // On submit:
      // handleSignIn(email, password)
    });
    async function handleSignIn(email, password) {
      const user = await authenticateUser(email, password);
      if (user && user.id) updateUIForLoggedInUser(user);
      // else show error
    }

    // ========== Step 4: Cultural Context Integration ==========
    async function fetchCulturalAdaptations(langCode) {
      // Simulate DB fetch
      return fetch(`/api/culture/${langCode}`).then(r => r.json());
    }
    async function setUserCulturalContext(langCode) {
      const data = await fetchCulturalAdaptations(langCode);
      // TODO: update text, placeholders, etc. with data
    }
    document.getElementById('lang')?.addEventListener('change', (e) => {
      setUserCulturalContext(e.target.value);
    });
    document.getElementById('footerLang')?.addEventListener('change', (e) => {
      setUserCulturalContext(e.target.value);
    });

    // ========== Virtual Human & Support Mode UI Toggles ==========
    function setVhMode(active) {
      document.getElementById('vhBadge').style.display = active ? '' : 'none';
      document.getElementById('vhAvatar').style.display = active ? 'flex' : 'none';
    }
    document.getElementById('vhToggle')?.addEventListener('click', () => {
      const active = !document.getElementById('vhBadge').style.display;
      setVhMode(active);
    });

    function setSupportMode(active) {
      document.getElementById('supportBadge').style.display = active ? '' : 'none';
      document.getElementById('supportPrompt').textContent = active
        ? 'Ask me About Pmerit' : 'Empowering Learning Through Innovation...';
    }
    document.getElementById('supportToggle')?.addEventListener('click', () => {
      const active = !document.getElementById('supportBadge').style.display;
      setSupportMode(active);
    });

    // ========== Accessibility: Font/Contrast toggle ==========
    document.getElementById('toggleFont')?.addEventListener('click', () => {
      document.body.style.fontSize = document.body.style.fontSize === '1.25em' ? '' : '1.25em';
    });
    document.getElementById('toggleContrast')?.addEventListener('click', () => {
      document.body.classList.toggle('dark');
    });

    // ========== Sidebar Collapsible for Mobile ==========
    document.getElementById('settingsBox')?.querySelector('.head')?.addEventListener('click', function() {
      const body = document.getElementById('settingsBox').querySelector('.body');
      body.style.display = body.style.display === 'block' ? 'none' : 'block';
    });
  </script>
</body>
</html>
